<!DOCTYPE html>
<!-- saved from url=(0055)https://docs.docker.com/engine/reference/builder/#label -->
<html lang="en" class="js"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <!-- Google Tag Manager -->
  <script type="text/javascript" async="" src="./Dockerfile reference _ Docker Documentation_files/linkid.js"></script><script type="text/javascript" async="" src="./Dockerfile reference _ Docker Documentation_files/analytics.js"></script><script id="pd-rating-js" src="./Dockerfile reference _ Docker Documentation_files/rating.js"></script><script type="text/javascript" async="" src="./Dockerfile reference _ Docker Documentation_files/munchkin.js"></script><script type="text/javascript" async="" src="./Dockerfile reference _ Docker Documentation_files/analytics.min.js"></script><script type="text/javascript" async="" src="./Dockerfile reference _ Docker Documentation_files/f.txt"></script><script async="" src="./Dockerfile reference _ Docker Documentation_files/gtm.js"></script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WL2QLG5');</script>
<title>Dockerfile reference | Docker Documentation</title>
  <meta name="description" content="Dockerfiles use a simple DSL which allows you to automate the steps you would normally manually take to create an image.">
  <meta name="keywords" content="builder, docker, Dockerfile, automation, image creation">
  <link rel="canonical" href="https://docs.docker.com/engine/reference/builder/">

  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="https://docs.docker.com/favicons/docs@2x.ico" sizes="129x128">
  <link rel="apple-touch-icon" type="image/x-icon" href="https://docs.docker.com/favicons/docs@2x.ico" sizes="129x128">
  <meta name="msapplication-TileImage" content="/favicons/docs@2x.ico">
  <meta property="og:image" content="/favicons/docs@2x.ico">
  <meta name="theme-color" content="#2496ed">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- hide elements that are only shown without JavaScript enabled -->
  <script>document.documentElement.classList.add('js')</script>
  <style>html.js .no-js { display: none !important; }</style><script defer="" src="./Dockerfile reference _ Docker Documentation_files/theme-switcher.js"></script>
  <script defer="" src="./Dockerfile reference _ Docker Documentation_files/anchorlinks.js"></script>
  <script defer="" src="./Dockerfile reference _ Docker Documentation_files/jquery.js"></script>
  <script defer="" src="./Dockerfile reference _ Docker Documentation_files/bootstrap.min.js"></script>
  <script defer="" src="./Dockerfile reference _ Docker Documentation_files/docs.js"></script><script defer="" src="./Dockerfile reference _ Docker Documentation_files/search.js"></script><link rel="preload" as="font" href="https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFVZ0bf8pkAg.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="https://docs.docker.com/fonts/geomanist/hinted-Geomanist-Book.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="https://docs.docker.com/fonts/geomanist/hinted-Geomanist-Regular.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="https://docs.docker.com/fonts/glyphicons-halflings-regular.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="https://docs.docker.com/fonts/fontawesome-webfont.woff2?v=4.7.0" type="font/woff2" crossorigin="anonymous">

  <link rel="stylesheet" href="./Dockerfile reference _ Docker Documentation_files/font-awesome.min.css">
  <link rel="stylesheet" href="./Dockerfile reference _ Docker Documentation_files/bootstrap.min.css">
  <link rel="stylesheet" href="./Dockerfile reference _ Docker Documentation_files/style.css" id="pagestyle">

  <!-- SEO stuff -->
  <meta name="twitter:title" itemprop="title name" content="Dockerfile reference">
  <meta name="twitter:description" property="og:description" itemprop="description" content="">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:domain" content="docs.docker.com">
  <meta name="twitter:site" content="@docker_docs">
  <meta name="twitter:url" content="https://twitter.com/docker_docs">
  <meta name="twitter:image:src" content="https://docs.docker.com/images/docs@2x.png">
  <meta name="twitter:image:alt" content="Docker Documentation">
  <meta property="og:title" content="Dockerfile reference">
  <meta property="og:description" content="Dockerfiles use a simple DSL which allows you to automate the steps you would normally manually take to create an image.">
  <meta property="og:type" content="website">
  <meta property="og:updated_time" itemprop="dateUpdated" content="2021-12-23T17:55:17+00:00">
  <meta property="og:image" itemprop="image primaryImageOfPage" content="https://docs.docker.com/images/docs@2x.png">
  <meta property="og:locale" content="en_US">
  <meta property="og:url" content="https://docs.docker.com/engine/reference/builder/">
  <meta property="og:site_name" content="Docker Documentation">
  <meta property="article:published_time" itemprop="datePublished" content="2021-12-23T17:55:17+00:00">
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","headline":"Dockerfile reference","description":"Dockerfiles use a simple DSL which allows you to automate the steps you would normally manually take to create an image.","url":"https://docs.docker.com/engine/reference/builder/"}</script>
  <!-- END SEO STUFF -->
<script type="text/javascript" async="" src="./Dockerfile reference _ Docker Documentation_files/munchkin(1).js"></script><script src="./Dockerfile reference _ Docker Documentation_files/f(1).txt"></script><script charset="utf-8" src="./Dockerfile reference _ Docker Documentation_files/rate.php"></script><script charset="utf-8" src="./Dockerfile reference _ Docker Documentation_files/rating-results.php"></script><style type="text/css" id="pd_popup_holder_style_8453675">#pd_popup_holder_8453675 { position:absolute; display:none; width:175px; height:auto; top:0px; left:0px; z-index:10000; border:solid 1px #CCC; background-color:white; padding:0px 15px;font-family:Arial,Sans;box-shadow: -10px 10px 20px rgba(0, 0, 0, .5);-webkit-box-shadow: 0px 0px 6px rgba(0, 0, 0, .25);-moz-box-shadow: 0px 0px 6px rgba(0, 0, 0, .25); }</style></head>
<body class="colums"><div id="announcement-bar" style="display: block; width: 100%; min-height: 38px; padding: 10px 40px; background: rgb(0, 44, 102); text-align: center; color: white; font-size: 13px; font-weight: 600;">Get the latest on Apache Log4j 2 CVE-2021-44228 vulnerability from <a id="dkr_log4j_global_banner" href="https://www.docker.com/blog/apache-log4j-2-cve-2021-44228/">Docker</a><div id="docker-global-alert-dismiss" style="cursor: pointer; position: absolute; top: 6px; right: 14px; font-size: 16px;">✕</div></div>
    <header>
        <nav class="nav-secondary navbar navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="https://docs.docker.com/">
                <img class="logo" src="./Dockerfile reference _ Docker Documentation_files/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs" width="160" height="28">
            </a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="logo-mobile">
    <a href="https://docs.docker.com/">
        <img src="./Dockerfile reference _ Docker Documentation_files/docker-icon.svg" alt="Docker Docs" title="Docker Docs" width="30" height="30">
    </a>
</div>
<div class="search-form" id="search-div">
    <form class="search-form form-inline" id="searchForm" action="https://docs.docker.com/search/" method="get">
        <label for="st-search-input" class="sr-only">Search</label>
        <input class="search-field form-control ds-input" id="st-search-input" name="q" placeholder="Search the docs" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteResults"></div>
        <!-- <button type="submit" class="search-submit btn btn-default">Search</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container hidden-sm hidden-xs">
    <div>
        <ul class="nav navbar-nav"><li><a href="https://docs.docker.com/" id="home">Home</a></li><li><a href="https://docs.docker.com/get-started/overview/" id="guides">Guides</a></li><li><a href="https://docs.docker.com/desktop/" id="manuals">Manuals</a></li><li class="active"><a href="https://docs.docker.com/reference/" id="reference">Reference</a></li><li><a href="https://docs.docker.com/samples/" id="samples">Samples</a></li></ul>
    </div>
    <div class="ctrl-right">
        <a href="javascript:void(0)" id="menu-toggle" aria-label="Current page&#39;s menu toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
    </div>
</div>
<div class="row hidden-sm hidden-xs">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li><a href="https://docs.docker.com/" title="Docker docs homepage"><i class="fa fa-home"></i></a></li>
            <li><a href="https://docs.docker.com/reference/">Reference</a></li><li><a href="https://docs.docker.com/engine/reference/builder/">Dockerfile reference</a></li></ol>
    </nav>
</div></div>
    </div>
</nav>

    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section"><h1 id="title">Dockerfile reference</h1><p><em class="reading-time">Estimated reading time: 81 minutes</em></p><!-- This file is maintained within the docker/cli GitHub
     repository at https://github.com/docker/cli/. Make all
     pull requests against that repo. If you see this file in
     another repository, consider it read-only there, as it will
     periodically be overwritten by the definitive file. Pull
     requests which include edits to this file in other repositories
     will be rejected.
-->

<p>Docker can build images automatically by reading the instructions from a
<code class="highlighter-rouge">Dockerfile</code>. A <code class="highlighter-rouge">Dockerfile</code> is a text document that contains all the commands a
user could call on the command line to assemble an image. Using <code class="highlighter-rouge">docker build</code>
users can create an automated build that executes several command-line
instructions in succession.</p>

<p>This page describes the commands you can use in a <code class="highlighter-rouge">Dockerfile</code>. When you are
done reading this page, refer to the <a href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/"><code class="highlighter-rouge">Dockerfile</code> Best
Practices</a> for a tip-oriented guide.</p>

<h2 id="usage">Usage<a href="https://docs.docker.com/engine/reference/builder/#usage" class="anchorLink">🔗</a></h2>

<p>The <a href="https://docs.docker.com/engine/reference/commandline/build/">docker build</a> command builds an image from
a <code class="highlighter-rouge">Dockerfile</code> and a <em>context</em>. The build’s context is the set of files at a
specified location <code class="highlighter-rouge">PATH</code> or <code class="highlighter-rouge">URL</code>. The <code class="highlighter-rouge">PATH</code> is a directory on your local
filesystem. The <code class="highlighter-rouge">URL</code> is a Git repository location.</p>

<p>The build context is processed recursively. So, a <code class="highlighter-rouge">PATH</code> includes any subdirectories
and the <code class="highlighter-rouge">URL</code> includes the repository and its submodules. This example shows a
build command that uses the current directory (<code class="highlighter-rouge">.</code>) as build context:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker build <span class="nb">.</span>
<span class="go">
Sending build context to Docker daemon  6.51 MB
</span><span class="c">...
</span></code></pre></div></div>

<p>The build is run by the Docker daemon, not by the CLI. The first thing a build
process does is send the entire context (recursively) to the daemon.  In most
cases, it’s best to start with an empty directory as context and keep your
Dockerfile in that directory. Add only the files needed for building the
Dockerfile.</p>

<blockquote class="warning">
  <p><strong>Warning</strong></p>

  <p>Do not use your root directory, <code class="highlighter-rouge">/</code>, as the <code class="highlighter-rouge">PATH</code> for  your build context, as
it causes the build to transfer the entire contents of your hard drive to the
Docker daemon.</p>
</blockquote>

<p>To use a file in the build context, the <code class="highlighter-rouge">Dockerfile</code> refers to the file specified
in an instruction, for example,  a <code class="highlighter-rouge">COPY</code> instruction. To increase the build’s
performance, exclude files and directories by adding a <code class="highlighter-rouge">.dockerignore</code> file to
the context directory.  For information about how to <a href="https://docs.docker.com/engine/reference/builder/#dockerignore-file">create a <code class="highlighter-rouge">.dockerignore</code>
file</a> see the documentation on this page.</p>

<p>Traditionally, the <code class="highlighter-rouge">Dockerfile</code> is called <code class="highlighter-rouge">Dockerfile</code> and located in the root
of the context. You use the <code class="highlighter-rouge">-f</code> flag with <code class="highlighter-rouge">docker build</code> to point to a Dockerfile
anywhere in your file system.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker build <span class="nt">-f</span> /path/to/a/Dockerfile <span class="nb">.</span>
</code></pre></div></div>

<p>You can specify a repository and tag at which to save the new image if
the build succeeds:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker build <span class="nt">-t</span> shykes/myapp <span class="nb">.</span>
</code></pre></div></div>

<p>To tag the image into multiple repositories after the build,
add multiple <code class="highlighter-rouge">-t</code> parameters when you run the <code class="highlighter-rouge">build</code> command:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker build <span class="nt">-t</span> shykes/myapp:1.0.2 <span class="nt">-t</span> shykes/myapp:latest <span class="nb">.</span>
</code></pre></div></div>

<p>Before the Docker daemon runs the instructions in the <code class="highlighter-rouge">Dockerfile</code>, it performs
a preliminary validation of the <code class="highlighter-rouge">Dockerfile</code> and returns an error if the syntax is incorrect:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker build <span class="nt">-t</span> <span class="nb">test</span>/myapp <span class="nb">.</span>
<span class="go">
[+] Building 0.3s (2/2) FINISHED
</span><span class="gp"> =&gt;</span> <span class="o">[</span>internal] load build definition from Dockerfile                       0.1s
<span class="gp"> =&gt;</span> <span class="o">=&gt;</span> transferring dockerfile: 60B                                        0.0s
<span class="gp"> =&gt;</span> <span class="o">[</span>internal] load .dockerignore                                          0.1s
<span class="gp"> =&gt;</span> <span class="o">=&gt;</span> transferring context: 2B                                            0.0s
<span class="go">error: failed to solve: rpc error: code = Unknown desc = failed to solve with frontend dockerfile.v0: failed to create LLB definition:
dockerfile parse error line 2: unknown instruction: RUNCMD
</span></code></pre></div></div>

<p>The Docker daemon runs the instructions in the <code class="highlighter-rouge">Dockerfile</code> one-by-one,
committing the result of each instruction
to a new image if necessary, before finally outputting the ID of your
new image. The Docker daemon will automatically clean up the context you
sent.</p>

<p>Note that each instruction is run independently, and causes a new image
to be created - so <code class="highlighter-rouge">RUN cd /tmp</code> will not have any effect on the next
instructions.</p>

<p>Whenever possible, Docker uses a build-cache to accelerate the <code class="highlighter-rouge">docker build</code>
process significantly. This is indicated by the <code class="highlighter-rouge">CACHED</code> message in the console
output. (For more information, see the <a href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/"><code class="highlighter-rouge">Dockerfile</code> best practices guide</a>:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker build <span class="nt">-t</span> svendowideit/ambassador <span class="nb">.</span>
<span class="go">
[+] Building 0.7s (6/6) FINISHED
</span><span class="gp"> =&gt;</span> <span class="o">[</span>internal] load build definition from Dockerfile                       0.1s
<span class="gp"> =&gt;</span> <span class="o">=&gt;</span> transferring dockerfile: 286B                                       0.0s
<span class="gp"> =&gt;</span> <span class="o">[</span>internal] load .dockerignore                                          0.1s
<span class="gp"> =&gt;</span> <span class="o">=&gt;</span> transferring context: 2B                                            0.0s
<span class="gp"> =&gt;</span> <span class="o">[</span>internal] load metadata <span class="k">for </span>docker.io/library/alpine:3.2              0.4s
<span class="gp"> =&gt;</span> CACHED <span class="o">[</span>1/2] FROM docker.io/library/alpine:3.2@sha256:e9a2035f9d0d7ce  0.0s
<span class="gp"> =&gt;</span> CACHED <span class="o">[</span>2/2] RUN apk add <span class="nt">--no-cache</span> socat                              0.0s
<span class="gp"> =&gt;</span> exporting to image                                                     0.0s
<span class="gp"> =&gt;</span> <span class="o">=&gt;</span> exporting layers                                                    0.0s
<span class="gp"> =&gt;</span> <span class="o">=&gt;</span> writing image sha256:1affb80ca37018ac12067fa2af38cc5bcc2a8f09963de  0.0s
<span class="gp"> =&gt;</span> <span class="o">=&gt;</span> naming to docker.io/svendowideit/ambassador                         0.0s
</code></pre></div></div>

<p>By default, the build cache is based on results from previous builds on the machine
on which you are building. The <code class="highlighter-rouge">--cache-from</code> option also allows you to use a
build-cache that’s distributed through an image registry refer to the
<a href="https://docs.docker.com/engine/reference/commandline/build/#specifying-external-cache-sources">specifying external cache sources</a>
section in the <code class="highlighter-rouge">docker build</code> command reference.</p>

<p>When you’re done with your build, you’re ready to look into <a href="https://docs.docker.com/engine/scan/">scanning your image with <code class="highlighter-rouge">docker scan</code></a>,
and <a href="https://docs.docker.com/docker-hub/repos/">pushing your image to Docker Hub</a>.</p>

<h2 id="buildkit">BuildKit<a href="https://docs.docker.com/engine/reference/builder/#buildkit" class="anchorLink">🔗</a></h2>

<p>Starting with version 18.09, Docker supports a new backend for executing your
builds that is provided by the <a href="https://github.com/moby/buildkit">moby/buildkit</a>
project. The BuildKit backend provides many benefits compared to the old
implementation. For example, BuildKit can:</p>

<ul>
  <li>Detect and skip executing unused build stages</li>
  <li>Parallelize building independent build stages</li>
  <li>Incrementally transfer only the changed files in your build context between builds</li>
  <li>Detect and skip transferring unused files in your build context</li>
  <li>Use external Dockerfile implementations with many new features</li>
  <li>Avoid side-effects with rest of the API (intermediate images and containers)</li>
  <li>Prioritize your build cache for automatic pruning</li>
</ul>

<p>To use the BuildKit backend, you need to set an environment variable
<code class="highlighter-rouge">DOCKER_BUILDKIT=1</code> on the CLI before invoking <code class="highlighter-rouge">docker build</code>.</p>

<p>To learn about the experimental Dockerfile syntax available to BuildKit-based
builds <a href="https://github.com/moby/buildkit/blob/master/frontend/dockerfile/docs/experimental.md">refer to the documentation in the BuildKit repository</a>.</p>

<h2 id="format">Format<a href="https://docs.docker.com/engine/reference/builder/#format" class="anchorLink">🔗</a></h2>

<p>Here is the format of the <code class="highlighter-rouge">Dockerfile</code>:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Comment</span>
INSTRUCTION arguments
</code></pre></div></div>

<p>The instruction is not case-sensitive. However, convention is for them to
be UPPERCASE to distinguish them from arguments more easily.</p>

<p>Docker runs instructions in a <code class="highlighter-rouge">Dockerfile</code> in order. A <code class="highlighter-rouge">Dockerfile</code> <strong>must
begin with a <code class="highlighter-rouge">FROM</code> instruction</strong>. This may be after <a href="https://docs.docker.com/engine/reference/builder/#parser-directives">parser
directives</a>, <a href="https://docs.docker.com/engine/reference/builder/#format">comments</a>, and globally scoped
<a href="https://docs.docker.com/engine/reference/builder/#arg">ARGs</a>. The <code class="highlighter-rouge">FROM</code> instruction specifies the <a href="https://docs.docker.com/glossary/#parent-image"><em>Parent
Image</em></a> from which you are
building. <code class="highlighter-rouge">FROM</code> may only be preceded by one or more <code class="highlighter-rouge">ARG</code> instructions, which
declare arguments that are used in <code class="highlighter-rouge">FROM</code> lines in the <code class="highlighter-rouge">Dockerfile</code>.</p>

<p>Docker treats lines that <em>begin</em> with <code class="highlighter-rouge">#</code> as a comment, unless the line is
a valid <a href="https://docs.docker.com/engine/reference/builder/#parser-directives">parser directive</a>. A <code class="highlighter-rouge">#</code> marker anywhere
else in a line is treated as an argument. This allows statements like:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Comment</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo</span> <span class="s1">'we are running some # of cool things'</span>
</code></pre></div></div>

<p>Comment lines are removed before the Dockerfile instructions are executed, which
means that the comment in the following example is not handled by the shell
executing the <code class="highlighter-rouge">echo</code> command, and both examples below are equivalent:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">RUN </span><span class="nb">echo </span>hello <span class="se">\
</span><span class="c"># comment</span>
world
</code></pre></div></div>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">RUN </span><span class="nb">echo </span>hello <span class="se">\
</span>world
</code></pre></div></div>

<p>Line continuation characters are not supported in comments.</p>

<blockquote>
  <p><strong>Note on whitespace</strong></p>

  <p>For backward compatibility, leading whitespace before comments (<code class="highlighter-rouge">#</code>) and
instructions (such as <code class="highlighter-rouge">RUN</code>) are ignored, but discouraged. Leading whitespace
is not preserved in these cases, and the following examples are therefore
equivalent:</p>

  <div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="c"># this is a comment-line</span>
    RUN echo hello
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo </span>world
</code></pre></div>  </div>

  <div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># this is a comment-line</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo </span>hello
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo </span>world
</code></pre></div>  </div>

  <p>Note however, that whitespace in instruction <em>arguments</em>, such as the commands
following <code class="highlighter-rouge">RUN</code>, are preserved, so the following example prints `    hello    world`
with leading whitespace as specified:</p>

  <div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">RUN </span><span class="nb">echo</span> <span class="s2">"</span><span class="se">\
</span><span class="s2">     hello</span><span class="se">\
</span><span class="s2">     world"</span>
</code></pre></div>  </div>
</blockquote>

<h2 id="parser-directives">Parser directives<a href="https://docs.docker.com/engine/reference/builder/#parser-directives" class="anchorLink">🔗</a></h2>

<p>Parser directives are optional, and affect the way in which subsequent lines
in a <code class="highlighter-rouge">Dockerfile</code> are handled. Parser directives do not add layers to the build,
and will not be shown as a build step. Parser directives are written as a
special type of comment in the form <code class="highlighter-rouge"># directive=value</code>. A single directive
may only be used once.</p>

<p>Once a comment, empty line or builder instruction has been processed, Docker
no longer looks for parser directives. Instead it treats anything formatted
as a parser directive as a comment and does not attempt to validate if it might
be a parser directive. Therefore, all parser directives must be at the very
top of a <code class="highlighter-rouge">Dockerfile</code>.</p>

<p>Parser directives are not case-sensitive. However, convention is for them to
be lowercase. Convention is also to include a blank line following any
parser directives. Line continuation characters are not supported in parser
directives.</p>

<p>Due to these rules, the following examples are all invalid:</p>

<p>Invalid due to line continuation:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># direc \</span>
tive=value
</code></pre></div></div>

<p>Invalid due to appearing twice:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># directive=value1</span>
<span class="c"># directive=value2</span>

<span class="k" data-original-title="" title="">FROM</span><span class="s"> ImageName</span>
</code></pre></div></div>

<p>Treated as a comment due to appearing after a builder instruction:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ImageName</span>
<span class="c"># directive=value</span>
</code></pre></div></div>

<p>Treated as a comment due to appearing after a comment which is not a parser
directive:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># About my dockerfile</span>
<span class="c"># directive=value</span>
<span class="k" data-original-title="" title="">FROM</span><span class="s"> ImageName</span>
</code></pre></div></div>

<p>The unknown directive is treated as a comment due to not being recognized. In
addition, the known directive is treated as a comment due to appearing after
a comment which is not a parser directive.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># unknowndirective=value</span>
<span class="c"># knowndirective=value</span>
</code></pre></div></div>

<p>Non line-breaking whitespace is permitted in a parser directive. Hence, the
following lines are all treated identically:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#directive=value</span>
<span class="c"># directive =value</span>
<span class="c">#	directive= value</span>
<span class="c"># directive = value</span>
<span class="c">#	  dIrEcTiVe=value</span>
</code></pre></div></div>

<p>The following parser directives are supported:</p>

<ul>
  <li><code class="highlighter-rouge">syntax</code></li>
  <li><code class="highlighter-rouge">escape</code></li>
</ul>

<h2 id="syntax">syntax<a href="https://docs.docker.com/engine/reference/builder/#syntax" class="anchorLink">🔗</a></h2>

<p><a name="external-implementation-features"><!-- included for deep-links to old section --></a></p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># syntax=[remote image reference]</span>
</code></pre></div></div>

<p>For example:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># syntax=docker/dockerfile:1</span>
<span class="c"># syntax=docker.io/docker/dockerfile:1</span>
<span class="c"># syntax=example.com/user/repo:tag@sha256:abcdef...</span>
</code></pre></div></div>

<p>This feature is only available when using the <a href="https://docs.docker.com/engine/reference/builder/#buildkit">BuildKit</a> backend, and
is ignored when using the classic builder backend.</p>

<p>The syntax directive defines the location of the Dockerfile syntax that is used
to build the Dockerfile. The BuildKit backend allows to seamlessly use external
implementations that are distributed as Docker images and execute inside a
container sandbox environment.</p>

<p>Custom Dockerfile implementations allows you to:</p>

<ul>
  <li>Automatically get bugfixes without updating the Docker daemon</li>
  <li>Make sure all users are using the same implementation to build your Dockerfile</li>
  <li>Use the latest features without updating the Docker daemon</li>
  <li>Try out new features or third-party features before they are integrated in the Docker daemon</li>
  <li>Use <a href="https://github.com/moby/buildkit#exploring-llb">alternative build definitions, or create your own</a></li>
</ul>

<h3 id="official-releases">Official releases<a href="https://docs.docker.com/engine/reference/builder/#official-releases" class="anchorLink">🔗</a></h3>

<p>Docker distributes official versions of the images that can be used for building
Dockerfiles under <code class="highlighter-rouge">docker/dockerfile</code> repository on Docker Hub. There are two
channels where new images are released: <code class="highlighter-rouge">stable</code> and <code class="highlighter-rouge">labs</code>.</p>

<p>Stable channel follows <a href="https://semver.org/">semantic versioning</a>. For example:</p>

<ul>
  <li><code class="highlighter-rouge">docker/dockerfile:1</code> - kept updated with the latest <code class="highlighter-rouge">1.x.x</code> minor <em>and</em> patch release</li>
  <li><code class="highlighter-rouge">docker/dockerfile:1.2</code> -  kept updated with the latest <code class="highlighter-rouge">1.2.x</code> patch release,
and stops receiving updates once version <code class="highlighter-rouge">1.3.0</code> is released.</li>
  <li><code class="highlighter-rouge">docker/dockerfile:1.2.1</code> - immutable: never updated</li>
</ul>

<p>We recommend using <code class="highlighter-rouge">docker/dockerfile:1</code>, which always points to the latest stable
release of the version 1 syntax, and receives both “minor” and “patch” updates
for the version 1 release cycle. BuildKit automatically checks for updates of the
syntax when performing a build, making sure you are using the most current version.</p>

<p>If a specific version is used, such as <code class="highlighter-rouge">1.2</code> or <code class="highlighter-rouge">1.2.1</code>, the Dockerfile needs to
be updated manually to continue receiving bugfixes and new features. Old versions
of the Dockerfile remain compatible with the new versions of the builder.</p>

<p><strong>labs channel</strong></p>

<p>The “labs” channel provides early access to Dockerfile features that are not yet
available in the stable channel. Labs channel images are released in conjunction
with the stable releases, and follow the same versioning with the <code class="highlighter-rouge">-labs</code> suffix,
for example:</p>

<ul>
  <li><code class="highlighter-rouge">docker/dockerfile:labs</code> - latest release on labs channel</li>
  <li><code class="highlighter-rouge">docker/dockerfile:1-labs</code> - same as <code class="highlighter-rouge">dockerfile:1</code> in the stable channel, with labs features enabled</li>
  <li><code class="highlighter-rouge">docker/dockerfile:1.2-labs</code> -  same as <code class="highlighter-rouge">dockerfile:1.2</code> in the stable channel, with labs features enabled</li>
  <li><code class="highlighter-rouge">docker/dockerfile:1.2.1-labs</code> - immutable: never updated. Same as <code class="highlighter-rouge">dockerfile:1.2.1</code> in the stable channel, with labs features enabled</li>
</ul>

<p>Choose a channel that best fits your needs; if you want to benefit from
new features, use the labs channel. Images in the labs channel provide a superset
of the features in the stable channel; note that <code class="highlighter-rouge">stable</code> features in the labs
channel images follow <a href="https://semver.org/">semantic versioning</a>, but “labs”
features do not, and newer releases may not be backwards compatible, so it
is recommended to use an immutable full version variant.</p>

<p>For documentation on “labs” features, master builds, and nightly feature releases,
refer to the description in <a href="https://github.com/moby/buildkit/blob/master/README.md">the BuildKit source repository on GitHub</a>.
For a full list of available images, visit the <a href="https://hub.docker.com/r/docker/dockerfile">image repository on Docker Hub</a>,
and the <a href="https://hub.docker.com/r/docker/dockerfile-upstream">docker/dockerfile-upstream image repository</a>
for development builds.</p>

<h2 id="escape">escape<a href="https://docs.docker.com/engine/reference/builder/#escape" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># escape=\ (backslash)</span>
</code></pre></div></div>

<p>Or</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># escape=` (backtick)</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">escape</code> directive sets the character used to escape characters in a
<code class="highlighter-rouge">Dockerfile</code>. If not specified, the default escape character is <code class="highlighter-rouge">\</code>.</p>

<p>The escape character is used both to escape characters in a line, and to
escape a newline. This allows a <code class="highlighter-rouge">Dockerfile</code> instruction to
span multiple lines. Note that regardless of whether the <code class="highlighter-rouge">escape</code> parser
directive is included in a <code class="highlighter-rouge">Dockerfile</code>, <em>escaping is not performed in
a <code class="highlighter-rouge">RUN</code> command, except at the end of a line.</em></p>

<p>Setting the escape character to <code class="highlighter-rouge">`</code> is especially useful on
<code class="highlighter-rouge">Windows</code>, where <code class="highlighter-rouge">\</code> is the directory path separator. <code class="highlighter-rouge">`</code> is consistent
with <a href="https://technet.microsoft.com/en-us/library/hh847755.aspx">Windows PowerShell</a>.</p>

<p>Consider the following example which would fail in a non-obvious way on
<code class="highlighter-rouge">Windows</code>. The second <code class="highlighter-rouge">\</code> at the end of the second line would be interpreted as an
escape for the newline, instead of a target of the escape from the first <code class="highlighter-rouge">\</code>.
Similarly, the <code class="highlighter-rouge">\</code> at the end of the third line would, assuming it was actually
handled as an instruction, cause it be treated as a line continuation. The result
of this dockerfile is that second and third lines are considered a single
instruction:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> microsoft/nanoserver</span>
<span class="k" data-original-title="" title="">COPY</span><span class="s"> testfile.txt c:\\</span>
<span class="k" data-original-title="" title="">RUN </span>dir c:<span class="se">\
</span></code></pre></div></div>

<p>Results in:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">PS E:\myproject&gt;</span> docker build <span class="nt">-t</span> cmd <span class="nb">.</span>
<span class="go">
Sending build context to Docker daemon 3.072 kB
Step 1/2 : FROM microsoft/nanoserver
</span><span class="gp"> ---&gt;</span> 22738ff49c6d
<span class="go">Step 2/2 : COPY testfile.txt c:\RUN dir c:
GetFileAttributesEx c:RUN: The system cannot find the file specified.
</span><span class="gp">PS E:\myproject&gt;</span>
</code></pre></div></div>

<p>One solution to the above would be to use <code class="highlighter-rouge">/</code> as the target of both the <code class="highlighter-rouge">COPY</code>
instruction, and <code class="highlighter-rouge">dir</code>. However, this syntax is, at best, confusing as it is not
natural for paths on <code class="highlighter-rouge">Windows</code>, and at worst, error prone as not all commands on
<code class="highlighter-rouge">Windows</code> support <code class="highlighter-rouge">/</code> as the path separator.</p>

<p>By adding the <code class="highlighter-rouge">escape</code> parser directive, the following <code class="highlighter-rouge">Dockerfile</code> succeeds as
expected with the use of natural platform semantics for file paths on <code class="highlighter-rouge">Windows</code>:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># escape=`</span>

<span class="k" data-original-title="" title="">FROM</span><span class="s"> microsoft/nanoserver</span>
<span class="k" data-original-title="" title="">COPY</span><span class="s"> testfile.txt c:\</span>
<span class="k" data-original-title="" title="">RUN </span>dir c:<span class="se">\
</span></code></pre></div></div>

<p>Results in:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">PS E:\myproject&gt;</span> docker build <span class="nt">-t</span> succeeds <span class="nt">--no-cache</span><span class="o">=</span><span class="nb">true</span> <span class="nb">.</span>
<span class="go">
Sending build context to Docker daemon 3.072 kB
Step 1/3 : FROM microsoft/nanoserver
</span><span class="gp"> ---&gt;</span> 22738ff49c6d
<span class="gp">Step 2/3 : COPY testfile.txt c:\
 ---&gt;</span> 96655de338de
<span class="go">Removing intermediate container 4db9acbb1682
</span><span class="gp">Step 3/3 : RUN dir c:\
 ---&gt;</span> Running <span class="k">in </span>a2c157f842f5
<span class="go"> Volume in drive C has no label.
 Volume Serial Number is 7E6D-E0F7

 Directory of c:\

10/05/2016  05:04 PM             1,894 License.txt
</span><span class="gp">10/05/2016  02:22 PM    &lt;DIR&gt;</span>          Program Files
<span class="gp">10/05/2016  02:14 PM    &lt;DIR&gt;</span>          Program Files <span class="o">(</span>x86<span class="o">)</span>
<span class="go">10/28/2016  11:18 AM                62 testfile.txt
</span><span class="gp">10/28/2016  11:20 AM    &lt;DIR&gt;</span>          Users
<span class="gp">10/28/2016  11:20 AM    &lt;DIR&gt;</span>          Windows
<span class="go">           2 File(s)          1,956 bytes
           4 Dir(s)  21,259,096,064 bytes free
</span><span class="gp"> ---&gt;</span> 01c7f3bef04f
<span class="go">Removing intermediate container a2c157f842f5
Successfully built 01c7f3bef04f
</span><span class="gp">PS E:\myproject&gt;</span>
</code></pre></div></div>

<h2 id="environment-replacement">Environment replacement<a href="https://docs.docker.com/engine/reference/builder/#environment-replacement" class="anchorLink">🔗</a></h2>

<p>Environment variables (declared with <a href="https://docs.docker.com/engine/reference/builder/#env">the <code class="highlighter-rouge">ENV</code> statement</a>) can also be
used in certain instructions as variables to be interpreted by the
<code class="highlighter-rouge">Dockerfile</code>. Escapes are also handled for including variable-like syntax
into a statement literally.</p>

<p>Environment variables are notated in the <code class="highlighter-rouge">Dockerfile</code> either with
<code class="highlighter-rouge">$variable_name</code> or <code class="highlighter-rouge">${variable_name}</code>. They are treated equivalently and the
brace syntax is typically used to address issues with variable names with no
whitespace, like <code class="highlighter-rouge">${foo}_bar</code>.</p>

<p>The <code class="highlighter-rouge">${variable_name}</code> syntax also supports a few of the standard <code class="highlighter-rouge">bash</code>
modifiers as specified below:</p>

<ul>
  <li><code class="highlighter-rouge">${variable:-word}</code> indicates that if <code class="highlighter-rouge">variable</code> is set then the result
will be that value. If <code class="highlighter-rouge">variable</code> is not set then <code class="highlighter-rouge">word</code> will be the result.</li>
  <li><code class="highlighter-rouge">${variable:+word}</code> indicates that if <code class="highlighter-rouge">variable</code> is set then <code class="highlighter-rouge">word</code> will be
the result, otherwise the result is the empty string.</li>
</ul>

<p>In all cases, <code class="highlighter-rouge">word</code> can be any string, including additional environment
variables.</p>

<p>Escaping is possible by adding a <code class="highlighter-rouge">\</code> before the variable: <code class="highlighter-rouge">\$foo</code> or <code class="highlighter-rouge">\${foo}</code>,
for example, will translate to <code class="highlighter-rouge">$foo</code> and <code class="highlighter-rouge">${foo}</code> literals respectively.</p>

<p>Example (parsed representation is displayed after the <code class="highlighter-rouge">#</code>):</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> busybox</span>
<span class="k" data-original-title="" title="">ENV</span><span class="s"> FOO=/bar</span>
<span class="k" data-original-title="" title="">WORKDIR</span><span class="s"> ${FOO}   # WORKDIR /bar</span>
<span class="k" data-original-title="" title="">ADD</span><span class="s"> . $FOO       # ADD . /bar</span>
<span class="k" data-original-title="" title="">COPY</span><span class="s"> \$FOO /quux # COPY $FOO /quux</span>
</code></pre></div></div>

<p>Environment variables are supported by the following list of instructions in
the <code class="highlighter-rouge">Dockerfile</code>:</p>

<ul>
  <li><code class="highlighter-rouge">ADD</code></li>
  <li><code class="highlighter-rouge">COPY</code></li>
  <li><code class="highlighter-rouge">ENV</code></li>
  <li><code class="highlighter-rouge">EXPOSE</code></li>
  <li><code class="highlighter-rouge">FROM</code></li>
  <li><code class="highlighter-rouge">LABEL</code></li>
  <li><code class="highlighter-rouge">STOPSIGNAL</code></li>
  <li><code class="highlighter-rouge">USER</code></li>
  <li><code class="highlighter-rouge">VOLUME</code></li>
  <li><code class="highlighter-rouge">WORKDIR</code></li>
  <li><code class="highlighter-rouge">ONBUILD</code> (when combined with one of the supported instructions above)</li>
</ul>

<p>Environment variable substitution will use the same value for each variable
throughout the entire instruction. In other words, in this example:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ENV</span><span class="s"> abc=hello</span>
<span class="k" data-original-title="" title="">ENV</span><span class="s"> abc=bye def=$abc</span>
<span class="k" data-original-title="" title="">ENV</span><span class="s"> ghi=$abc</span>
</code></pre></div></div>

<p>will result in <code class="highlighter-rouge">def</code> having a value of <code class="highlighter-rouge">hello</code>, not <code class="highlighter-rouge">bye</code>. However,
<code class="highlighter-rouge">ghi</code> will have a value of <code class="highlighter-rouge">bye</code> because it is not part of the same instruction
that set <code class="highlighter-rouge">abc</code> to <code class="highlighter-rouge">bye</code>.</p>

<h2 id="dockerignore-file">.dockerignore file<a href="https://docs.docker.com/engine/reference/builder/#dockerignore-file" class="anchorLink">🔗</a></h2>

<p>Before the docker CLI sends the context to the docker daemon, it looks
for a file named <code class="highlighter-rouge">.dockerignore</code> in the root directory of the context.
If this file exists, the CLI modifies the context to exclude files and
directories that match patterns in it.  This helps to avoid
unnecessarily sending large or sensitive files and directories to the
daemon and potentially adding them to images using <code class="highlighter-rouge">ADD</code> or <code class="highlighter-rouge">COPY</code>.</p>

<p>The CLI interprets the <code class="highlighter-rouge">.dockerignore</code> file as a newline-separated
list of patterns similar to the file globs of Unix shells.  For the
purposes of matching, the root of the context is considered to be both
the working and the root directory.  For example, the patterns
<code class="highlighter-rouge">/foo/bar</code> and <code class="highlighter-rouge">foo/bar</code> both exclude a file or directory named <code class="highlighter-rouge">bar</code>
in the <code class="highlighter-rouge">foo</code> subdirectory of <code class="highlighter-rouge">PATH</code> or in the root of the git
repository located at <code class="highlighter-rouge">URL</code>.  Neither excludes anything else.</p>

<p>If a line in <code class="highlighter-rouge">.dockerignore</code> file starts with <code class="highlighter-rouge">#</code> in column 1, then this line is
considered as a comment and is ignored before interpreted by the CLI.</p>

<p>Here is an example <code class="highlighter-rouge">.dockerignore</code> file:</p>

<pre><code class="language-gitignore"># comment
*/temp*
*/*/temp*
temp?
</code></pre>

<p>This file causes the following build behavior:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Rule</th>
      <th style="text-align: left">Behavior</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge"># comment</code></td>
      <td style="text-align: left">Ignored.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">*/temp*</code></td>
      <td style="text-align: left">Exclude files and directories whose names start with <code class="highlighter-rouge">temp</code> in any immediate subdirectory of the root.  For example, the plain file <code class="highlighter-rouge">/somedir/temporary.txt</code> is excluded, as is the directory <code class="highlighter-rouge">/somedir/temp</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">*/*/temp*</code></td>
      <td style="text-align: left">Exclude files and directories starting with <code class="highlighter-rouge">temp</code> from any subdirectory that is two levels below the root. For example, <code class="highlighter-rouge">/somedir/subdir/temporary.txt</code> is excluded.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">temp?</code></td>
      <td style="text-align: left">Exclude files and directories in the root directory whose names are a one-character extension of <code class="highlighter-rouge">temp</code>.  For example, <code class="highlighter-rouge">/tempa</code> and <code class="highlighter-rouge">/tempb</code> are excluded.</td>
    </tr>
  </tbody>
</table>

<p>Matching is done using Go’s
<a href="https://golang.org/pkg/path/filepath#Match">filepath.Match</a> rules.  A
preprocessing step removes leading and trailing whitespace and
eliminates <code class="highlighter-rouge">.</code> and <code class="highlighter-rouge">..</code> elements using Go’s
<a href="https://golang.org/pkg/path/filepath/#Clean">filepath.Clean</a>.  Lines
that are blank after preprocessing are ignored.</p>

<p>Beyond Go’s filepath.Match rules, Docker also supports a special
wildcard string <code class="highlighter-rouge">**</code> that matches any number of directories (including
zero). For example, <code class="highlighter-rouge">**/*.go</code> will exclude all files that end with <code class="highlighter-rouge">.go</code>
that are found in all directories, including the root of the build context.</p>

<p>Lines starting with <code class="highlighter-rouge">!</code> (exclamation mark) can be used to make exceptions
to exclusions.  The following is an example <code class="highlighter-rouge">.dockerignore</code> file that
uses this mechanism:</p>

<pre><code class="language-gitignore">*.md
!README.md
</code></pre>

<p>All markdown files <em>except</em> <code class="highlighter-rouge">README.md</code> are excluded from the context.</p>

<p>The placement of <code class="highlighter-rouge">!</code> exception rules influences the behavior: the last
line of the <code class="highlighter-rouge">.dockerignore</code> that matches a particular file determines
whether it is included or excluded.  Consider the following example:</p>

<pre><code class="language-gitignore">*.md
!README*.md
README-secret.md
</code></pre>

<p>No markdown files are included in the context except README files other than
<code class="highlighter-rouge">README-secret.md</code>.</p>

<p>Now consider this example:</p>

<pre><code class="language-gitignore">*.md
README-secret.md
!README*.md
</code></pre>

<p>All of the README files are included.  The middle line has no effect because
<code class="highlighter-rouge">!README*.md</code> matches <code class="highlighter-rouge">README-secret.md</code> and comes last.</p>

<p>You can even use the <code class="highlighter-rouge">.dockerignore</code> file to exclude the <code class="highlighter-rouge">Dockerfile</code>
and <code class="highlighter-rouge">.dockerignore</code> files.  These files are still sent to the daemon
because it needs them to do its job.  But the <code class="highlighter-rouge">ADD</code> and <code class="highlighter-rouge">COPY</code> instructions
do not copy them to the image.</p>

<p>Finally, you may want to specify which files to include in the
context, rather than which to exclude. To achieve this, specify <code class="highlighter-rouge">*</code> as
the first pattern, followed by one or more <code class="highlighter-rouge">!</code> exception patterns.</p>

<blockquote>
  <p><strong>Note</strong></p>

  <p>For historical reasons, the pattern <code class="highlighter-rouge">.</code> is ignored.</p>
</blockquote>

<h2 id="from">FROM<a href="https://docs.docker.com/engine/reference/builder/#from" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> [--platform=&lt;platform&gt;] &lt;image&gt; [AS &lt;name&gt;]</span>
</code></pre></div></div>

<p>Or</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> [--platform=&lt;platform&gt;] &lt;image&gt;[:&lt;tag&gt;] [AS &lt;name&gt;]</span>
</code></pre></div></div>

<p>Or</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> [--platform=&lt;platform&gt;] &lt;image&gt;[@&lt;digest&gt;] [AS &lt;name&gt;]</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">FROM</code> instruction initializes a new build stage and sets the
<a href="https://docs.docker.com/glossary/#base-image"><em>Base Image</em></a> for subsequent instructions. As such, a
valid <code class="highlighter-rouge">Dockerfile</code> must start with a <code class="highlighter-rouge">FROM</code> instruction. The image can be
any valid image – it is especially easy to start by <strong>pulling an image</strong> from
the <a href="https://docs.docker.com/docker-hub/repos/"><em>Public Repositories</em></a>.</p>

<ul>
  <li><code class="highlighter-rouge">ARG</code> is the only instruction that may precede <code class="highlighter-rouge">FROM</code> in the <code class="highlighter-rouge">Dockerfile</code>.
See <a href="https://docs.docker.com/engine/reference/builder/#understand-how-arg-and-from-interact">Understand how ARG and FROM interact</a>.</li>
  <li><code class="highlighter-rouge">FROM</code> can appear multiple times within a single <code class="highlighter-rouge">Dockerfile</code> to
create multiple images or use one build stage as a dependency for another.
Simply make a note of the last image ID output by the commit before each new
<code class="highlighter-rouge">FROM</code> instruction. Each <code class="highlighter-rouge">FROM</code> instruction clears any state created by previous
instructions.</li>
  <li>Optionally a name can be given to a new build stage by adding <code class="highlighter-rouge">AS name</code> to the
<code class="highlighter-rouge">FROM</code> instruction. The name can be used in subsequent <code class="highlighter-rouge">FROM</code> and
<code class="highlighter-rouge">COPY --from=&lt;name&gt;</code> instructions to refer to the image built in this stage.</li>
  <li>The <code class="highlighter-rouge">tag</code> or <code class="highlighter-rouge">digest</code> values are optional. If you omit either of them, the
builder assumes a <code class="highlighter-rouge">latest</code> tag by default. The builder returns an error if it
cannot find the <code class="highlighter-rouge">tag</code> value.</li>
</ul>

<p>The optional <code class="highlighter-rouge">--platform</code> flag can be used to specify the platform of the image
in case <code class="highlighter-rouge">FROM</code> references a multi-platform image. For example, <code class="highlighter-rouge">linux/amd64</code>,
<code class="highlighter-rouge">linux/arm64</code>, or <code class="highlighter-rouge">windows/amd64</code>. By default, the target platform of the build
request is used. Global build arguments can be used in the value of this flag,
for example <a href="https://docs.docker.com/engine/reference/builder/#automatic-platform-args-in-the-global-scope">automatic platform ARGs</a>
allow you to force a stage to native build platform (<code class="highlighter-rouge">--platform=$BUILDPLATFORM</code>),
and use it to cross-compile to the target platform inside the stage.</p>

<h3 id="understand-how-arg-and-from-interact">Understand how ARG and FROM interact<a href="https://docs.docker.com/engine/reference/builder/#understand-how-arg-and-from-interact" class="anchorLink">🔗</a></h3>

<p><code class="highlighter-rouge">FROM</code> instructions support variables that are declared by any <code class="highlighter-rouge">ARG</code>
instructions that occur before the first <code class="highlighter-rouge">FROM</code>.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ARG</span><span class="s">  CODE_VERSION=latest</span>
<span class="k" data-original-title="" title="">FROM</span><span class="s"> base:${CODE_VERSION}</span>
<span class="k" data-original-title="" title="">CMD</span><span class="s">  /code/run-app</span>

<span class="k" data-original-title="" title="">FROM</span><span class="s"> extras:${CODE_VERSION}</span>
<span class="k" data-original-title="" title="">CMD</span><span class="s">  /code/run-extras</span>
</code></pre></div></div>

<p>An <code class="highlighter-rouge">ARG</code> declared before a <code class="highlighter-rouge">FROM</code> is outside of a build stage, so it
can’t be used in any instruction after a <code class="highlighter-rouge">FROM</code>. To use the default value of
an <code class="highlighter-rouge">ARG</code> declared before the first <code class="highlighter-rouge">FROM</code> use an <code class="highlighter-rouge">ARG</code> instruction without
a value inside of a build stage:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ARG</span><span class="s"> VERSION=latest</span>
<span class="k" data-original-title="" title="">FROM</span><span class="s"> busybox:$VERSION</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> VERSION</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo</span> <span class="nv">$VERSION</span> <span class="o">&gt;</span> image_version
</code></pre></div></div>

<h2 id="run">RUN<a href="https://docs.docker.com/engine/reference/builder/#run" class="anchorLink">🔗</a></h2>

<p>RUN has 2 forms:</p>

<ul>
  <li><code class="highlighter-rouge">RUN &lt;command&gt;</code> (<em>shell</em> form, the command is run in a shell, which by
default is <code class="highlighter-rouge">/bin/sh -c</code> on Linux or <code class="highlighter-rouge">cmd /S /C</code> on Windows)</li>
  <li><code class="highlighter-rouge">RUN ["executable", "param1", "param2"]</code> (<em>exec</em> form)</li>
</ul>

<p>The <code class="highlighter-rouge">RUN</code> instruction will execute any commands in a new layer on top of the
current image and commit the results. The resulting committed image will be
used for the next step in the <code class="highlighter-rouge">Dockerfile</code>.</p>

<p>Layering <code class="highlighter-rouge">RUN</code> instructions and generating commits conforms to the core
concepts of Docker where commits are cheap and containers can be created from
any point in an image’s history, much like source control.</p>

<p>The <em>exec</em> form makes it possible to avoid shell string munging, and to <code class="highlighter-rouge">RUN</code>
commands using a base image that does not contain the specified shell executable.</p>

<p>The default shell for the <em>shell</em> form can be changed using the <code class="highlighter-rouge">SHELL</code>
command.</p>

<p>In the <em>shell</em> form you can use a <code class="highlighter-rouge">\</code> (backslash) to continue a single
RUN instruction onto the next line. For example, consider these two lines:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">RUN </span>/bin/bash <span class="nt">-c</span> <span class="s1">'source $HOME/.bashrc; </span><span class="se">\
</span><span class="s1">echo $HOME'</span>
</code></pre></div></div>

<p>Together they are equivalent to this single line:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">RUN </span>/bin/bash <span class="nt">-c</span> <span class="s1">'source $HOME/.bashrc; echo $HOME'</span>
</code></pre></div></div>

<p>To use a different shell, other than ‘/bin/sh’, use the <em>exec</em> form passing in
the desired shell. For example:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">RUN </span><span class="o">[</span><span class="s2">"/bin/bash"</span>, <span class="s2">"-c"</span>, <span class="s2">"echo hello"</span><span class="o">]</span>
</code></pre></div></div>

<blockquote>
  <p><strong>Note</strong></p>

  <p>The <em>exec</em> form is parsed as a JSON array, which means that
you must use double-quotes (“) around words not single-quotes (‘).</p>
</blockquote>

<p>Unlike the <em>shell</em> form, the <em>exec</em> form does not invoke a command shell.
This means that normal shell processing does not happen. For example,
<code class="highlighter-rouge">RUN [ "echo", "$HOME" ]</code> will not do variable substitution on <code class="highlighter-rouge">$HOME</code>.
If you want shell processing then either use the <em>shell</em> form or execute
a shell directly, for example: <code class="highlighter-rouge">RUN [ "sh", "-c", "echo $HOME" ]</code>.
When using the exec form and executing a shell directly, as in the case for
the shell form, it is the shell that is doing the environment variable
expansion, not docker.</p>

<blockquote>
  <p><strong>Note</strong></p>

  <p>In the <em>JSON</em> form, it is necessary to escape backslashes. This is
particularly relevant on Windows where the backslash is the path separator.
The following line would otherwise be treated as <em>shell</em> form due to not
being valid JSON, and fail in an unexpected way:</p>

  <div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">RUN </span><span class="o">[</span><span class="s2">"c:</span><span class="se">\w</span><span class="s2">indows</span><span class="se">\s</span><span class="s2">ystem32</span><span class="se">\t</span><span class="s2">asklist.exe"</span><span class="o">]</span>
</code></pre></div>  </div>

  <p>The correct syntax for this example is:</p>

  <div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">RUN </span><span class="o">[</span><span class="s2">"c:</span><span class="se">\\</span><span class="s2">windows</span><span class="se">\\</span><span class="s2">system32</span><span class="se">\\</span><span class="s2">tasklist.exe"</span><span class="o">]</span>
</code></pre></div>  </div>
</blockquote>

<p>The cache for <code class="highlighter-rouge">RUN</code> instructions isn’t invalidated automatically during
the next build. The cache for an instruction like
<code class="highlighter-rouge">RUN apt-get dist-upgrade -y</code> will be reused during the next build. The
cache for <code class="highlighter-rouge">RUN</code> instructions can be invalidated by using the <code class="highlighter-rouge">--no-cache</code>
flag, for example <code class="highlighter-rouge">docker build --no-cache</code>.</p>

<p>See the <a href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/"><code class="highlighter-rouge">Dockerfile</code> Best Practices
guide</a> for more information.</p>

<p>The cache for <code class="highlighter-rouge">RUN</code> instructions can be invalidated by <a href="https://docs.docker.com/engine/reference/builder/#add"><code class="highlighter-rouge">ADD</code></a> and <a href="https://docs.docker.com/engine/reference/builder/#copy"><code class="highlighter-rouge">COPY</code></a> instructions.</p>

<h3 id="known-issues-run">Known issues (RUN)<a href="https://docs.docker.com/engine/reference/builder/#known-issues-run" class="anchorLink">🔗</a></h3>

<ul>
  <li>
    <p><a href="https://github.com/docker/docker/issues/783">Issue 783</a> is about file
permissions problems that can occur when using the AUFS file system. You
might notice it during an attempt to <code class="highlighter-rouge">rm</code> a file, for example.</p>

    <p>For systems that have recent aufs version (i.e., <code class="highlighter-rouge">dirperm1</code> mount option can
be set), docker will attempt to fix the issue automatically by mounting
the layers with <code class="highlighter-rouge">dirperm1</code> option. More details on <code class="highlighter-rouge">dirperm1</code> option can be
found at <a href="https://github.com/sfjro/aufs3-linux/tree/aufs3.18/Documentation/filesystems/aufs"><code class="highlighter-rouge">aufs</code> man page</a></p>

    <p>If your system doesn’t have support for <code class="highlighter-rouge">dirperm1</code>, the issue describes a workaround.</p>
  </li>
</ul>

<h2 id="cmd">CMD<a href="https://docs.docker.com/engine/reference/builder/#cmd" class="anchorLink">🔗</a></h2>

<p>The <code class="highlighter-rouge">CMD</code> instruction has three forms:</p>

<ul>
  <li><code class="highlighter-rouge">CMD ["executable","param1","param2"]</code> (<em>exec</em> form, this is the preferred form)</li>
  <li><code class="highlighter-rouge">CMD ["param1","param2"]</code> (as <em>default parameters to ENTRYPOINT</em>)</li>
  <li><code class="highlighter-rouge">CMD command param1 param2</code> (<em>shell</em> form)</li>
</ul>

<p>There can only be one <code class="highlighter-rouge">CMD</code> instruction in a <code class="highlighter-rouge">Dockerfile</code>. If you list more than one <code class="highlighter-rouge">CMD</code>
then only the last <code class="highlighter-rouge">CMD</code> will take effect.</p>

<p><strong>The main purpose of a <code class="highlighter-rouge">CMD</code> is to provide defaults for an executing
container.</strong> These defaults can include an executable, or they can omit
the executable, in which case you must specify an <code class="highlighter-rouge">ENTRYPOINT</code>
instruction as well.</p>

<p>If <code class="highlighter-rouge">CMD</code> is used to provide default arguments for the <code class="highlighter-rouge">ENTRYPOINT</code> instruction,
both the <code class="highlighter-rouge">CMD</code> and <code class="highlighter-rouge">ENTRYPOINT</code> instructions should be specified with the JSON
array format.</p>

<blockquote>
  <p><strong>Note</strong></p>

  <p>The <em>exec</em> form is parsed as a JSON array, which means that you must use
double-quotes (“) around words not single-quotes (‘).</p>
</blockquote>

<p>Unlike the <em>shell</em> form, the <em>exec</em> form does not invoke a command shell.
This means that normal shell processing does not happen. For example,
<code class="highlighter-rouge">CMD [ "echo", "$HOME" ]</code> will not do variable substitution on <code class="highlighter-rouge">$HOME</code>.
If you want shell processing then either use the <em>shell</em> form or execute
a shell directly, for example: <code class="highlighter-rouge">CMD [ "sh", "-c", "echo $HOME" ]</code>.
When using the exec form and executing a shell directly, as in the case for
the shell form, it is the shell that is doing the environment variable
expansion, not docker.</p>

<p>When used in the shell or exec formats, the <code class="highlighter-rouge">CMD</code> instruction sets the command
to be executed when running the image.</p>

<p>If you use the <em>shell</em> form of the <code class="highlighter-rouge">CMD</code>, then the <code class="highlighter-rouge">&lt;command&gt;</code> will execute in
<code class="highlighter-rouge">/bin/sh -c</code>:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">CMD</span><span class="s"> echo "This is a test." | wc -</span>
</code></pre></div></div>

<p>If you want to <strong>run your</strong> <code class="highlighter-rouge">&lt;command&gt;</code> <strong>without a shell</strong> then you must
express the command as a JSON array and give the full path to the executable.
<strong>This array form is the preferred format of <code class="highlighter-rouge">CMD</code>.</strong> Any additional parameters
must be individually expressed as strings in the array:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">CMD</span><span class="s"> ["/usr/bin/wc","--help"]</span>
</code></pre></div></div>

<p>If you would like your container to run the same executable every time, then
you should consider using <code class="highlighter-rouge">ENTRYPOINT</code> in combination with <code class="highlighter-rouge">CMD</code>. See
<a href="https://docs.docker.com/engine/reference/builder/#entrypoint"><em>ENTRYPOINT</em></a>.</p>

<p>If the user specifies arguments to <code class="highlighter-rouge">docker run</code> then they will override the
default specified in <code class="highlighter-rouge">CMD</code>.</p>

<blockquote>
  <p><strong>Note</strong></p>

  <p>Do not confuse <code class="highlighter-rouge">RUN</code> with <code class="highlighter-rouge">CMD</code>. <code class="highlighter-rouge">RUN</code> actually runs a command and commits
the result; <code class="highlighter-rouge">CMD</code> does not execute anything at build time, but specifies
the intended command for the image.</p>
</blockquote>

<h2 id="label">LABEL<a href="https://docs.docker.com/engine/reference/builder/#label" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">LABEL</span><span class="s"> &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">LABEL</code> instruction adds metadata to an image. A <code class="highlighter-rouge">LABEL</code> is a
key-value pair. To include spaces within a <code class="highlighter-rouge">LABEL</code> value, use quotes and
backslashes as you would in command-line parsing. A few usage examples:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="" style="cursor: help;">LABEL</span><span class="s"> "com.example.vendor"="ACME Incorporated"</span>
<span class="k" data-original-title="" title="" style="cursor: help;">LABEL</span><span class="s"> com.example.label-with-value="foo"</span>
<span class="k" data-original-title="" title="" style="cursor: help;">LABEL</span><span class="s"> version="1.0"</span>
<span class="k" data-original-title="" title="" style="cursor: help;">LABEL</span><span class="s"> description="This text illustrates \</span>
that label-values can span multiple lines."
</code></pre></div></div>

<p>An image can have more than one label. You can specify multiple labels on a
single line. Prior to Docker 1.10, this decreased the size of the final image,
but this is no longer the case. You may still choose to specify multiple labels
in a single instruction, in one of the following two ways:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">LABEL</span><span class="s"> multi.label1="value1" multi.label2="value2" other="value3"</span>
</code></pre></div></div>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">LABEL</span><span class="s"> multi.label1="value1" \</span>
      multi.label2="value2" \
      other="value3"
</code></pre></div></div>

<p>Labels included in base or parent images (images in the <code class="highlighter-rouge">FROM</code> line) are
inherited by your image. If a label already exists but with a different value,
the most-recently-applied value overrides any previously-set value.</p>

<p>To view an image’s labels, use the <code class="highlighter-rouge">docker image inspect</code> command. You can use
the <code class="highlighter-rouge">--format</code> option to show just the labels;</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker image inspect <span class="nt">--format</span><span class="o">=</span><span class="s1">''</span> myimage
</code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"com.example.vendor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ACME Incorporated"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"com.example.label-with-value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This text illustrates that label-values can span multiple lines."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"multi.label1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"multi.label2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value2"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"other"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value3"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="maintainer-deprecated">MAINTAINER (deprecated)<a href="https://docs.docker.com/engine/reference/builder/#maintainer-deprecated" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">MAINTAINER</span><span class="s"> &lt;name&gt;</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">MAINTAINER</code> instruction sets the <em>Author</em> field of the generated images.
The <code class="highlighter-rouge">LABEL</code> instruction is a much more flexible version of this and you should use
it instead, as it enables setting any metadata you require, and can be viewed
easily, for example with <code class="highlighter-rouge">docker inspect</code>. To set a label corresponding to the
<code class="highlighter-rouge">MAINTAINER</code> field you could use:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">LABEL</span><span class="s"> org.opencontainers.image.authors="SvenDowideit@home.org.au"</span>
</code></pre></div></div>

<p>This will then be visible from <code class="highlighter-rouge">docker inspect</code> with the other labels.</p>

<h2 id="expose">EXPOSE<a href="https://docs.docker.com/engine/reference/builder/#expose" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">EXPOSE</span><span class="s"> &lt;port&gt; [&lt;port&gt;/&lt;protocol&gt;...]</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">EXPOSE</code> instruction informs Docker that the container listens on the
specified network ports at runtime. You can specify whether the port listens on
TCP or UDP, and the default is TCP if the protocol is not specified.</p>

<p>The <code class="highlighter-rouge">EXPOSE</code> instruction does not actually publish the port. It functions as a
type of documentation between the person who builds the image and the person who
runs the container, about which ports are intended to be published. To actually
publish the port when running the container, use the <code class="highlighter-rouge">-p</code> flag on <code class="highlighter-rouge">docker run</code>
to publish and map one or more ports, or the <code class="highlighter-rouge">-P</code> flag to publish all exposed
ports and map them to high-order ports.</p>

<p>By default, <code class="highlighter-rouge">EXPOSE</code> assumes TCP. You can also specify UDP:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">EXPOSE</span><span class="s"> 80/udp</span>
</code></pre></div></div>

<p>To expose on both TCP and UDP, include two lines:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">EXPOSE</span><span class="s"> 80/tcp</span>
<span class="k" data-original-title="" title="">EXPOSE</span><span class="s"> 80/udp</span>
</code></pre></div></div>

<p>In this case, if you use <code class="highlighter-rouge">-P</code> with <code class="highlighter-rouge">docker run</code>, the port will be exposed once
for TCP and once for UDP. Remember that <code class="highlighter-rouge">-P</code> uses an ephemeral high-ordered host
port on the host, so the port will not be the same for TCP and UDP.</p>

<p>Regardless of the <code class="highlighter-rouge">EXPOSE</code> settings, you can override them at runtime by using
the <code class="highlighter-rouge">-p</code> flag. For example</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">-p</span> 80:80/tcp <span class="nt">-p</span> 80:80/udp ...
</code></pre></div></div>

<p>To set up port redirection on the host system, see <a href="https://docs.docker.com/engine/reference/run/#expose-incoming-ports">using the -P flag</a>.
The <code class="highlighter-rouge">docker network</code> command supports creating networks for communication among
containers without the need to expose or publish specific ports, because the
containers connected to the network can communicate with each other over any
port. For detailed information, see the
<a href="https://docs.docker.com/engine/userguide/networking/">overview of this feature</a>.</p>

<h2 id="env">ENV<a href="https://docs.docker.com/engine/reference/builder/#env" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ENV</span><span class="s"> &lt;key&gt;=&lt;value&gt; ...</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">ENV</code> instruction sets the environment variable <code class="highlighter-rouge">&lt;key&gt;</code> to the value
<code class="highlighter-rouge">&lt;value&gt;</code>. This value will be in the environment for all subsequent instructions
in the build stage and can be <a href="https://docs.docker.com/engine/reference/builder/#environment-replacement">replaced inline</a> in
many as well. The value will be interpreted for other environment variables, so
quote characters will be removed if they are not escaped. Like command line parsing,
quotes and backslashes can be used to include spaces within values.</p>

<p>Example:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ENV</span><span class="s"> MY_NAME="John Doe"</span>
<span class="k" data-original-title="" title="">ENV</span><span class="s"> MY_DOG=Rex\ The\ Dog</span>
<span class="k" data-original-title="" title="">ENV</span><span class="s"> MY_CAT=fluffy</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">ENV</code> instruction allows for multiple <code class="highlighter-rouge">&lt;key&gt;=&lt;value&gt; ...</code> variables to be set
at one time, and the example below will yield the same net results in the final
image:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ENV</span><span class="s"> MY_NAME="John Doe" MY_DOG=Rex\ The\ Dog \</span>
    MY_CAT=fluffy
</code></pre></div></div>

<p>The environment variables set using <code class="highlighter-rouge">ENV</code> will persist when a container is run
from the resulting image. You can view the values using <code class="highlighter-rouge">docker inspect</code>, and
change them using <code class="highlighter-rouge">docker run --env &lt;key&gt;=&lt;value&gt;</code>.</p>

<p>Environment variable persistence can cause unexpected side effects. For example,
setting <code class="highlighter-rouge">ENV DEBIAN_FRONTEND=noninteractive</code> changes the behavior of <code class="highlighter-rouge">apt-get</code>,
and may confuse users of your image.</p>

<p>If an environment variable is only needed during build, and not in the final
image, consider setting a value for a single command instead:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">RUN </span><span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive apt-get update <span class="o">&amp;&amp;</span> apt-get install <span class="nt">-y</span> ...
</code></pre></div></div>

<p>Or using <a href="https://docs.docker.com/engine/reference/builder/#arg"><code class="highlighter-rouge">ARG</code></a>, which is not persisted in the final image:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ARG</span><span class="s"> DEBIAN_FRONTEND=noninteractive</span>
<span class="k" data-original-title="" title="">RUN </span>apt-get update <span class="o">&amp;&amp;</span> apt-get install <span class="nt">-y</span> ...
</code></pre></div></div>

<blockquote>
  <p><strong>Alternative syntax</strong></p>

  <p>The <code class="highlighter-rouge">ENV</code> instruction also allows an alternative syntax <code class="highlighter-rouge">ENV &lt;key&gt; &lt;value&gt;</code>,
omitting the <code class="highlighter-rouge">=</code>. For example:</p>

  <div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ENV</span><span class="s"> MY_VAR my-value</span>
</code></pre></div>  </div>

  <p>This syntax does not allow for multiple environment-variables to be set in a
single <code class="highlighter-rouge">ENV</code> instruction, and can be confusing. For example, the following
sets a single environment variable (<code class="highlighter-rouge">ONE</code>) with value <code class="highlighter-rouge">"TWO= THREE=world"</code>:</p>

  <div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ENV</span><span class="s"> ONE TWO= THREE=world</span>
</code></pre></div>  </div>

  <p>The alternative syntax is supported for backward compatibility, but discouraged
for the reasons outlined above, and may be removed in a future release.</p>
</blockquote>

<h2 id="add">ADD<a href="https://docs.docker.com/engine/reference/builder/#add" class="anchorLink">🔗</a></h2>

<p>ADD has two forms:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ADD</span><span class="s"> [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dest&gt;</span>
<span class="k" data-original-title="" title="">ADD</span><span class="s"> [--chown=&lt;user&gt;:&lt;group&gt;] ["&lt;src&gt;",... "&lt;dest&gt;"]</span>
</code></pre></div></div>

<p>The latter form is required for paths containing whitespace.</p>

<blockquote>
  <p><strong>Note</strong></p>

  <p>The <code class="highlighter-rouge">--chown</code> feature is only supported on Dockerfiles used to build Linux containers,
and will not work on Windows containers. Since user and group ownership concepts do
not translate between Linux and Windows, the use of <code class="highlighter-rouge">/etc/passwd</code> and <code class="highlighter-rouge">/etc/group</code> for
translating user and group names to IDs restricts this feature to only be viable
for Linux OS-based containers.</p>
</blockquote>

<p>The <code class="highlighter-rouge">ADD</code> instruction copies new files, directories or remote file URLs from <code class="highlighter-rouge">&lt;src&gt;</code>
and adds them to the filesystem of the image at the path <code class="highlighter-rouge">&lt;dest&gt;</code>.</p>

<p>Multiple <code class="highlighter-rouge">&lt;src&gt;</code> resources may be specified but if they are files or
directories, their paths are interpreted as relative to the source of
the context of the build.</p>

<p>Each <code class="highlighter-rouge">&lt;src&gt;</code> may contain wildcards and matching will be done using Go’s
<a href="https://golang.org/pkg/path/filepath#Match">filepath.Match</a> rules. For example:</p>

<p>To add all files starting with “hom”:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ADD</span><span class="s"> hom* /mydir/</span>
</code></pre></div></div>

<p>In the example below, <code class="highlighter-rouge">?</code> is replaced with any single character, e.g., “home.txt”.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ADD</span><span class="s"> hom?.txt /mydir/</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">&lt;dest&gt;</code> is an absolute path, or a path relative to <code class="highlighter-rouge">WORKDIR</code>, into which
the source will be copied inside the destination container.</p>

<p>The example below uses a relative path, and adds “test.txt” to <code class="highlighter-rouge">&lt;WORKDIR&gt;/relativeDir/</code>:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ADD</span><span class="s"> test.txt relativeDir/</span>
</code></pre></div></div>

<p>Whereas this example uses an absolute path, and adds “test.txt” to <code class="highlighter-rouge">/absoluteDir/</code></p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ADD</span><span class="s"> test.txt /absoluteDir/</span>
</code></pre></div></div>

<p>When adding files or directories that contain special characters (such as <code class="highlighter-rouge">[</code>
and <code class="highlighter-rouge">]</code>), you need to escape those paths following the Golang rules to prevent
them from being treated as a matching pattern. For example, to add a file
named <code class="highlighter-rouge">arr[0].txt</code>, use the following;</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ADD</span><span class="s"> arr[[]0].txt /mydir/</span>
</code></pre></div></div>

<p>All new files and directories are created with a UID and GID of 0, unless the
optional <code class="highlighter-rouge">--chown</code> flag specifies a given username, groupname, or UID/GID
combination to request specific ownership of the content added. The
format of the <code class="highlighter-rouge">--chown</code> flag allows for either username and groupname strings
or direct integer UID and GID in any combination. Providing a username without
groupname or a UID without GID will use the same numeric UID as the GID. If a
username or groupname is provided, the container’s root filesystem
<code class="highlighter-rouge">/etc/passwd</code> and <code class="highlighter-rouge">/etc/group</code> files will be used to perform the translation
from name to integer UID or GID respectively. The following examples show
valid definitions for the <code class="highlighter-rouge">--chown</code> flag:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ADD</span><span class="s"> --chown=55:mygroup files* /somedir/</span>
<span class="k" data-original-title="" title="">ADD</span><span class="s"> --chown=bin files* /somedir/</span>
<span class="k" data-original-title="" title="">ADD</span><span class="s"> --chown=1 files* /somedir/</span>
<span class="k" data-original-title="" title="">ADD</span><span class="s"> --chown=10:11 files* /somedir/</span>
</code></pre></div></div>

<p>If the container root filesystem does not contain either <code class="highlighter-rouge">/etc/passwd</code> or
<code class="highlighter-rouge">/etc/group</code> files and either user or group names are used in the <code class="highlighter-rouge">--chown</code>
flag, the build will fail on the <code class="highlighter-rouge">ADD</code> operation. Using numeric IDs requires
no lookup and will not depend on container root filesystem content.</p>

<p>In the case where <code class="highlighter-rouge">&lt;src&gt;</code> is a remote file URL, the destination will
have permissions of 600. If the remote file being retrieved has an HTTP
<code class="highlighter-rouge">Last-Modified</code> header, the timestamp from that header will be used
to set the <code class="highlighter-rouge">mtime</code> on the destination file. However, like any other file
processed during an <code class="highlighter-rouge">ADD</code>, <code class="highlighter-rouge">mtime</code> will not be included in the determination
of whether or not the file has changed and the cache should be updated.</p>

<blockquote>
  <p><strong>Note</strong></p>

  <p>If you build by passing a <code class="highlighter-rouge">Dockerfile</code> through STDIN (<code class="highlighter-rouge">docker
build - &lt; somefile</code>), there is no build context, so the <code class="highlighter-rouge">Dockerfile</code>
can only contain a URL based <code class="highlighter-rouge">ADD</code> instruction. You can also pass a
compressed archive through STDIN: (<code class="highlighter-rouge">docker build - &lt; archive.tar.gz</code>),
the <code class="highlighter-rouge">Dockerfile</code> at the root of the archive and the rest of the
archive will be used as the context of the build.</p>
</blockquote>

<p>If your URL files are protected using authentication, you need to use <code class="highlighter-rouge">RUN wget</code>,
<code class="highlighter-rouge">RUN curl</code> or use another tool from within the container as the <code class="highlighter-rouge">ADD</code> instruction
does not support authentication.</p>

<blockquote>
  <p><strong>Note</strong></p>

  <p>The first encountered <code class="highlighter-rouge">ADD</code> instruction will invalidate the cache for all
following instructions from the Dockerfile if the contents of <code class="highlighter-rouge">&lt;src&gt;</code> have
changed. This includes invalidating the cache for <code class="highlighter-rouge">RUN</code> instructions.
See the <a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#leverage-build-cache"><code class="highlighter-rouge">Dockerfile</code> Best Practices
guide –&nbsp;Leverage build cache</a>
for more information.</p>
</blockquote>

<p><code class="highlighter-rouge">ADD</code> obeys the following rules:</p>

<ul>
  <li>
    <p>The <code class="highlighter-rouge">&lt;src&gt;</code> path must be inside the <em>context</em> of the build;
you cannot <code class="highlighter-rouge">ADD ../something /something</code>, because the first step of a
<code class="highlighter-rouge">docker build</code> is to send the context directory (and subdirectories) to the
docker daemon.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">&lt;src&gt;</code> is a URL and <code class="highlighter-rouge">&lt;dest&gt;</code> does not end with a trailing slash, then a
file is downloaded from the URL and copied to <code class="highlighter-rouge">&lt;dest&gt;</code>.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">&lt;src&gt;</code> is a URL and <code class="highlighter-rouge">&lt;dest&gt;</code> does end with a trailing slash, then the
filename is inferred from the URL and the file is downloaded to
<code class="highlighter-rouge">&lt;dest&gt;/&lt;filename&gt;</code>. For instance, <code class="highlighter-rouge">ADD http://example.com/foobar /</code> would
create the file <code class="highlighter-rouge">/foobar</code>. The URL must have a nontrivial path so that an
appropriate filename can be discovered in this case (<code class="highlighter-rouge">http://example.com</code>
will not work).</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">&lt;src&gt;</code> is a directory, the entire contents of the directory are copied,
including filesystem metadata.</p>
  </li>
</ul>

<blockquote>
  <p><strong>Note</strong></p>

  <p>The directory itself is not copied, just its contents.</p>
</blockquote>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">&lt;src&gt;</code> is a <em>local</em> tar archive in a recognized compression format
(identity, gzip, bzip2 or xz) then it is unpacked as a directory. Resources
from <em>remote</em> URLs are <strong>not</strong> decompressed. When a directory is copied or
unpacked, it has the same behavior as <code class="highlighter-rouge">tar -x</code>, the result is the union of:</p>

    <ol>
      <li>Whatever existed at the destination path and</li>
      <li>The contents of the source tree, with conflicts resolved in favor
of “2.” on a file-by-file basis.</li>
    </ol>

    <blockquote>
      <p><strong>Note</strong></p>

      <p>Whether a file is identified as a recognized compression format or not
is done solely based on the contents of the file, not the name of the file.
For example, if an empty file happens to end with <code class="highlighter-rouge">.tar.gz</code> this will not
be recognized as a compressed file and <strong>will not</strong> generate any kind of
decompression error message, rather the file will simply be copied to the
destination.</p>
    </blockquote>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">&lt;src&gt;</code> is any other kind of file, it is copied individually along with
its metadata. In this case, if <code class="highlighter-rouge">&lt;dest&gt;</code> ends with a trailing slash <code class="highlighter-rouge">/</code>, it
will be considered a directory and the contents of <code class="highlighter-rouge">&lt;src&gt;</code> will be written
at <code class="highlighter-rouge">&lt;dest&gt;/base(&lt;src&gt;)</code>.</p>
  </li>
  <li>
    <p>If multiple <code class="highlighter-rouge">&lt;src&gt;</code> resources are specified, either directly or due to the
use of a wildcard, then <code class="highlighter-rouge">&lt;dest&gt;</code> must be a directory, and it must end with
a slash <code class="highlighter-rouge">/</code>.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">&lt;dest&gt;</code> does not end with a trailing slash, it will be considered a
regular file and the contents of <code class="highlighter-rouge">&lt;src&gt;</code> will be written at <code class="highlighter-rouge">&lt;dest&gt;</code>.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">&lt;dest&gt;</code> doesn’t exist, it is created along with all missing directories
in its path.</p>
  </li>
</ul>

<h2 id="copy">COPY<a href="https://docs.docker.com/engine/reference/builder/#copy" class="anchorLink">🔗</a></h2>

<p>COPY has two forms:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">COPY</span><span class="s"> [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dest&gt;</span>
<span class="k" data-original-title="" title="">COPY</span><span class="s"> [--chown=&lt;user&gt;:&lt;group&gt;] ["&lt;src&gt;",... "&lt;dest&gt;"]</span>
</code></pre></div></div>

<p>This latter form is required for paths containing whitespace</p>

<blockquote>
  <p><strong>Note</strong></p>

  <p>The <code class="highlighter-rouge">--chown</code> feature is only supported on Dockerfiles used to build Linux containers,
and will not work on Windows containers. Since user and group ownership concepts do
not translate between Linux and Windows, the use of <code class="highlighter-rouge">/etc/passwd</code> and <code class="highlighter-rouge">/etc/group</code> for
translating user and group names to IDs restricts this feature to only be viable for
Linux OS-based containers.</p>
</blockquote>

<p>The <code class="highlighter-rouge">COPY</code> instruction copies new files or directories from <code class="highlighter-rouge">&lt;src&gt;</code>
and adds them to the filesystem of the container at the path <code class="highlighter-rouge">&lt;dest&gt;</code>.</p>

<p>Multiple <code class="highlighter-rouge">&lt;src&gt;</code> resources may be specified but the paths of files and
directories will be interpreted as relative to the source of the context
of the build.</p>

<p>Each <code class="highlighter-rouge">&lt;src&gt;</code> may contain wildcards and matching will be done using Go’s
<a href="https://golang.org/pkg/path/filepath#Match">filepath.Match</a> rules. For example:</p>

<p>To add all files starting with “hom”:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">COPY</span><span class="s"> hom* /mydir/</span>
</code></pre></div></div>

<p>In the example below, <code class="highlighter-rouge">?</code> is replaced with any single character, e.g., “home.txt”.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">COPY</span><span class="s"> hom?.txt /mydir/</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">&lt;dest&gt;</code> is an absolute path, or a path relative to <code class="highlighter-rouge">WORKDIR</code>, into which
the source will be copied inside the destination container.</p>

<p>The example below uses a relative path, and adds “test.txt” to <code class="highlighter-rouge">&lt;WORKDIR&gt;/relativeDir/</code>:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">COPY</span><span class="s"> test.txt relativeDir/</span>
</code></pre></div></div>

<p>Whereas this example uses an absolute path, and adds “test.txt” to <code class="highlighter-rouge">/absoluteDir/</code></p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">COPY</span><span class="s"> test.txt /absoluteDir/</span>
</code></pre></div></div>

<p>When copying files or directories that contain special characters (such as <code class="highlighter-rouge">[</code>
and <code class="highlighter-rouge">]</code>), you need to escape those paths following the Golang rules to prevent
them from being treated as a matching pattern. For example, to copy a file
named <code class="highlighter-rouge">arr[0].txt</code>, use the following;</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">COPY</span><span class="s"> arr[[]0].txt /mydir/</span>
</code></pre></div></div>

<p>All new files and directories are created with a UID and GID of 0, unless the
optional <code class="highlighter-rouge">--chown</code> flag specifies a given username, groupname, or UID/GID
combination to request specific ownership of the copied content. The
format of the <code class="highlighter-rouge">--chown</code> flag allows for either username and groupname strings
or direct integer UID and GID in any combination. Providing a username without
groupname or a UID without GID will use the same numeric UID as the GID. If a
username or groupname is provided, the container’s root filesystem
<code class="highlighter-rouge">/etc/passwd</code> and <code class="highlighter-rouge">/etc/group</code> files will be used to perform the translation
from name to integer UID or GID respectively. The following examples show
valid definitions for the <code class="highlighter-rouge">--chown</code> flag:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">COPY</span><span class="s"> --chown=55:mygroup files* /somedir/</span>
<span class="k" data-original-title="" title="">COPY</span><span class="s"> --chown=bin files* /somedir/</span>
<span class="k" data-original-title="" title="">COPY</span><span class="s"> --chown=1 files* /somedir/</span>
<span class="k" data-original-title="" title="">COPY</span><span class="s"> --chown=10:11 files* /somedir/</span>
</code></pre></div></div>

<p>If the container root filesystem does not contain either <code class="highlighter-rouge">/etc/passwd</code> or
<code class="highlighter-rouge">/etc/group</code> files and either user or group names are used in the <code class="highlighter-rouge">--chown</code>
flag, the build will fail on the <code class="highlighter-rouge">COPY</code> operation. Using numeric IDs requires
no lookup and does not depend on container root filesystem content.</p>

<blockquote>
  <p><strong>Note</strong></p>

  <p>If you build using STDIN (<code class="highlighter-rouge">docker build - &lt; somefile</code>), there is no
build context, so <code class="highlighter-rouge">COPY</code> can’t be used.</p>
</blockquote>

<p>Optionally <code class="highlighter-rouge">COPY</code> accepts a flag <code class="highlighter-rouge">--from=&lt;name&gt;</code> that can be used to set
the source location to a previous build stage (created with <code class="highlighter-rouge">FROM .. AS &lt;name&gt;</code>)
that will be used instead of a build context sent by the user. In case a build
stage with a specified name can’t be found an image with the same name is
attempted to be used instead.</p>

<p><code class="highlighter-rouge">COPY</code> obeys the following rules:</p>

<ul>
  <li>
    <p>The <code class="highlighter-rouge">&lt;src&gt;</code> path must be inside the <em>context</em> of the build;
you cannot <code class="highlighter-rouge">COPY ../something /something</code>, because the first step of a
<code class="highlighter-rouge">docker build</code> is to send the context directory (and subdirectories) to the
docker daemon.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">&lt;src&gt;</code> is a directory, the entire contents of the directory are copied,
including filesystem metadata.</p>
  </li>
</ul>

<blockquote>
  <p><strong>Note</strong></p>

  <p>The directory itself is not copied, just its contents.</p>
</blockquote>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">&lt;src&gt;</code> is any other kind of file, it is copied individually along with
its metadata. In this case, if <code class="highlighter-rouge">&lt;dest&gt;</code> ends with a trailing slash <code class="highlighter-rouge">/</code>, it
will be considered a directory and the contents of <code class="highlighter-rouge">&lt;src&gt;</code> will be written
at <code class="highlighter-rouge">&lt;dest&gt;/base(&lt;src&gt;)</code>.</p>
  </li>
  <li>
    <p>If multiple <code class="highlighter-rouge">&lt;src&gt;</code> resources are specified, either directly or due to the
use of a wildcard, then <code class="highlighter-rouge">&lt;dest&gt;</code> must be a directory, and it must end with
a slash <code class="highlighter-rouge">/</code>.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">&lt;dest&gt;</code> does not end with a trailing slash, it will be considered a
regular file and the contents of <code class="highlighter-rouge">&lt;src&gt;</code> will be written at <code class="highlighter-rouge">&lt;dest&gt;</code>.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">&lt;dest&gt;</code> doesn’t exist, it is created along with all missing directories
in its path.</p>
  </li>
</ul>

<blockquote>
  <p><strong>Note</strong></p>

  <p>The first encountered <code class="highlighter-rouge">COPY</code> instruction will invalidate the cache for all
following instructions from the Dockerfile if the contents of <code class="highlighter-rouge">&lt;src&gt;</code> have
changed. This includes invalidating the cache for <code class="highlighter-rouge">RUN</code> instructions.
See the <a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#leverage-build-cache"><code class="highlighter-rouge">Dockerfile</code> Best Practices
guide –&nbsp;Leverage build cache</a>
for more information.</p>
</blockquote>

<h2 id="entrypoint">ENTRYPOINT<a href="https://docs.docker.com/engine/reference/builder/#entrypoint" class="anchorLink">🔗</a></h2>

<p>ENTRYPOINT has two forms:</p>

<p>The <em>exec</em> form, which is the preferred form:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ENTRYPOINT</span><span class="s"> ["executable", "param1", "param2"]</span>
</code></pre></div></div>

<p>The <em>shell</em> form:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ENTRYPOINT</span><span class="s"> command param1 param2</span>
</code></pre></div></div>

<p>An <code class="highlighter-rouge">ENTRYPOINT</code> allows you to configure a container that will run as an executable.</p>

<p>For example, the following starts nginx with its default content, listening
on port 80:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">-i</span> <span class="nt">-t</span> <span class="nt">--rm</span> <span class="nt">-p</span> 80:80 nginx
</code></pre></div></div>

<p>Command line arguments to <code class="highlighter-rouge">docker run &lt;image&gt;</code> will be appended after all
elements in an <em>exec</em> form <code class="highlighter-rouge">ENTRYPOINT</code>, and will override all elements specified
using <code class="highlighter-rouge">CMD</code>.
This allows arguments to be passed to the entry point, i.e., <code class="highlighter-rouge">docker run &lt;image&gt; -d</code>
will pass the <code class="highlighter-rouge">-d</code> argument to the entry point.
You can override the <code class="highlighter-rouge">ENTRYPOINT</code> instruction using the <code class="highlighter-rouge">docker run --entrypoint</code>
flag.</p>

<p>The <em>shell</em> form prevents any <code class="highlighter-rouge">CMD</code> or <code class="highlighter-rouge">run</code> command line arguments from being
used, but has the disadvantage that your <code class="highlighter-rouge">ENTRYPOINT</code> will be started as a
subcommand of <code class="highlighter-rouge">/bin/sh -c</code>, which does not pass signals.
This means that the executable will not be the container’s <code class="highlighter-rouge">PID 1</code> - and
will <em>not</em> receive Unix signals - so your executable will not receive a
<code class="highlighter-rouge">SIGTERM</code> from <code class="highlighter-rouge">docker stop &lt;container&gt;</code>.</p>

<p>Only the last <code class="highlighter-rouge">ENTRYPOINT</code> instruction in the <code class="highlighter-rouge">Dockerfile</code> will have an effect.</p>

<h3 id="exec-form-entrypoint-example">Exec form ENTRYPOINT example<a href="https://docs.docker.com/engine/reference/builder/#exec-form-entrypoint-example" class="anchorLink">🔗</a></h3>

<p>You can use the <em>exec</em> form of <code class="highlighter-rouge">ENTRYPOINT</code> to set fairly stable default commands
and arguments and then use either form of <code class="highlighter-rouge">CMD</code> to set additional defaults that
are more likely to be changed.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">ENTRYPOINT</span><span class="s"> ["top", "-b"]</span>
<span class="k" data-original-title="" title="">CMD</span><span class="s"> ["-c"]</span>
</code></pre></div></div>

<p>When you run the container, you can see that <code class="highlighter-rouge">top</code> is the only process:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">-it</span> <span class="nt">--rm</span> <span class="nt">--name</span> <span class="nb">test  </span>top <span class="nt">-H</span>
<span class="go">
top - 08:25:00 up  7:27,  0 users,  load average: 0.00, 0.01, 0.05
Threads:   1 total,   1 running,   0 sleeping,   0 stopped,   0 zombie
%Cpu(s):  0.1 us,  0.1 sy,  0.0 ni, 99.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem:   2056668 total,  1616832 used,   439836 free,    99352 buffers
KiB Swap:  1441840 total,        0 used,  1441840 free.  1324440 cached Mem

  PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND
    1 root      20   0   19744   2336   2080 R  0.0  0.1   0:00.04 top
</span></code></pre></div></div>

<p>To examine the result further, you can use <code class="highlighter-rouge">docker exec</code>:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker <span class="nb">exec</span> <span class="nt">-it</span> <span class="nb">test </span>ps aux
<span class="go">
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  2.6  0.1  19752  2352 ?        Ss+  08:24   0:00 top -b -H
root         7  0.0  0.1  15572  2164 ?        R+   08:25   0:00 ps aux
</span></code></pre></div></div>

<p>And you can gracefully request <code class="highlighter-rouge">top</code> to shut down using <code class="highlighter-rouge">docker stop test</code>.</p>

<p>The following <code class="highlighter-rouge">Dockerfile</code> shows using the <code class="highlighter-rouge">ENTRYPOINT</code> to run Apache in the
foreground (i.e., as <code class="highlighter-rouge">PID 1</code>):</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> debian:stable</span>
<span class="k" data-original-title="" title="">RUN </span>apt-get update <span class="o">&amp;&amp;</span> apt-get install <span class="nt">-y</span> <span class="nt">--force-yes</span> apache2
<span class="k" data-original-title="" title="">EXPOSE</span><span class="s"> 80 443</span>
<span class="k" data-original-title="" title="">VOLUME</span><span class="s"> ["/var/www", "/var/log/apache2", "/etc/apache2"]</span>
<span class="k" data-original-title="" title="">ENTRYPOINT</span><span class="s"> ["/usr/sbin/apache2ctl", "-D", "FOREGROUND"]</span>
</code></pre></div></div>

<p>If you need to write a starter script for a single executable, you can ensure that
the final executable receives the Unix signals by using <code class="highlighter-rouge">exec</code> and <code class="highlighter-rouge">gosu</code>
commands:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-e</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> <span class="o">=</span> <span class="s1">'postgres'</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span>chown <span class="nt">-R</span> postgres <span class="s2">"</span><span class="nv">$PGDATA</span><span class="s2">"</span>

    <span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="k">$(</span><span class="nb">ls</span> <span class="nt">-A</span> <span class="s2">"</span><span class="nv">$PGDATA</span><span class="s2">"</span><span class="k">)</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span>gosu postgres initdb
    <span class="k">fi

    </span><span class="nb">exec </span>gosu postgres <span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>
<span class="k">fi

</span><span class="nb">exec</span> <span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>
</code></pre></div></div>

<p>Lastly, if you need to do some extra cleanup (or communicate with other containers)
on shutdown, or are co-ordinating more than one executable, you may need to ensure
that the <code class="highlighter-rouge">ENTRYPOINT</code> script receives the Unix signals, passes them on, and then
does some more work:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>
<span class="c"># Note: I've written this using sh so it works in the busybox container too</span>

<span class="c"># USE the trap if you need to also do manual cleanup after the service is stopped,</span>
<span class="c">#     or need to start multiple services in the one container</span>
<span class="nb">trap</span> <span class="s2">"echo TRAPed signal"</span> HUP INT QUIT TERM

<span class="c"># start service in background here</span>
/usr/sbin/apachectl start

<span class="nb">echo</span> <span class="s2">"[hit enter key to exit] or run 'docker stop &lt;container&gt;'"</span>
<span class="nb">read</span>

<span class="c"># stop service and clean up here</span>
<span class="nb">echo</span> <span class="s2">"stopping apache"</span>
/usr/sbin/apachectl stop

<span class="nb">echo</span> <span class="s2">"exited </span><span class="nv">$0</span><span class="s2">"</span>
</code></pre></div></div>

<p>If you run this image with <code class="highlighter-rouge">docker run -it --rm -p 80:80 --name test apache</code>,
you can then examine the container’s processes with <code class="highlighter-rouge">docker exec</code>, or <code class="highlighter-rouge">docker top</code>,
and then ask the script to stop Apache:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker <span class="nb">exec</span> <span class="nt">-it</span> <span class="nb">test </span>ps aux
<span class="go">
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  0.1  0.0   4448   692 ?        Ss+  00:42   0:00 /bin/sh /run.sh 123 cmd cmd2
root        19  0.0  0.2  71304  4440 ?        Ss   00:42   0:00 /usr/sbin/apache2 -k start
www-data    20  0.2  0.2 360468  6004 ?        Sl   00:42   0:00 /usr/sbin/apache2 -k start
www-data    21  0.2  0.2 360468  6000 ?        Sl   00:42   0:00 /usr/sbin/apache2 -k start
root        81  0.0  0.1  15572  2140 ?        R+   00:44   0:00 ps aux

</span><span class="gp">$</span> docker top <span class="nb">test</span>
<span class="go">
PID                 USER                COMMAND
10035               root                {run.sh} /bin/sh /run.sh 123 cmd cmd2
10054               root                /usr/sbin/apache2 -k start
10055               33                  /usr/sbin/apache2 -k start
10056               33                  /usr/sbin/apache2 -k start

</span><span class="gp">$</span> /usr/bin/time docker stop <span class="nb">test</span>
<span class="go">
test
real	0m 0.27s
user	0m 0.03s
sys	0m 0.03s
</span></code></pre></div></div>

<blockquote>
  <p><strong>Note</strong></p>

  <p>You can override the <code class="highlighter-rouge">ENTRYPOINT</code> setting using <code class="highlighter-rouge">--entrypoint</code>,
but this can only set the binary to <em>exec</em> (no <code class="highlighter-rouge">sh -c</code> will be used).</p>
</blockquote>

<blockquote>
  <p><strong>Note</strong></p>

  <p>The <em>exec</em> form is parsed as a JSON array, which means that
you must use double-quotes (“) around words not single-quotes (‘).</p>
</blockquote>

<p>Unlike the <em>shell</em> form, the <em>exec</em> form does not invoke a command shell.
This means that normal shell processing does not happen. For example,
<code class="highlighter-rouge">ENTRYPOINT [ "echo", "$HOME" ]</code> will not do variable substitution on <code class="highlighter-rouge">$HOME</code>.
If you want shell processing then either use the <em>shell</em> form or execute
a shell directly, for example: <code class="highlighter-rouge">ENTRYPOINT [ "sh", "-c", "echo $HOME" ]</code>.
When using the exec form and executing a shell directly, as in the case for
the shell form, it is the shell that is doing the environment variable
expansion, not docker.</p>

<h3 id="shell-form-entrypoint-example">Shell form ENTRYPOINT example<a href="https://docs.docker.com/engine/reference/builder/#shell-form-entrypoint-example" class="anchorLink">🔗</a></h3>

<p>You can specify a plain string for the <code class="highlighter-rouge">ENTRYPOINT</code> and it will execute in <code class="highlighter-rouge">/bin/sh -c</code>.
This form will use shell processing to substitute shell environment variables,
and will ignore any <code class="highlighter-rouge">CMD</code> or <code class="highlighter-rouge">docker run</code> command line arguments.
To ensure that <code class="highlighter-rouge">docker stop</code> will signal any long running <code class="highlighter-rouge">ENTRYPOINT</code> executable
correctly, you need to remember to start it with <code class="highlighter-rouge">exec</code>:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">ENTRYPOINT</span><span class="s"> exec top -b</span>
</code></pre></div></div>

<p>When you run this image, you’ll see the single <code class="highlighter-rouge">PID 1</code> process:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">-it</span> <span class="nt">--rm</span> <span class="nt">--name</span> <span class="nb">test </span>top
<span class="go">
Mem: 1704520K used, 352148K free, 0K shrd, 0K buff, 140368121167873K cached
CPU:   5% usr   0% sys   0% nic  94% idle   0% io   0% irq   0% sirq
Load average: 0.08 0.03 0.05 2/98 6
  PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND
    1     0 root     R     3164   0%   0% top -b
</span></code></pre></div></div>

<p>Which exits cleanly on <code class="highlighter-rouge">docker stop</code>:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> /usr/bin/time docker stop <span class="nb">test</span>
<span class="go">
test
real	0m 0.20s
user	0m 0.02s
sys	0m 0.04s
</span></code></pre></div></div>

<p>If you forget to add <code class="highlighter-rouge">exec</code> to the beginning of your <code class="highlighter-rouge">ENTRYPOINT</code>:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">ENTRYPOINT</span><span class="s"> top -b</span>
<span class="k" data-original-title="" title="">CMD</span><span class="s"> --ignored-param1</span>
</code></pre></div></div>

<p>You can then run it (giving it a name for the next step):</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">-it</span> <span class="nt">--name</span> <span class="nb">test </span>top <span class="nt">--ignored-param2</span>
<span class="go">
Mem: 1704184K used, 352484K free, 0K shrd, 0K buff, 140621524238337K cached
CPU:   9% usr   2% sys   0% nic  88% idle   0% io   0% irq   0% sirq
Load average: 0.01 0.02 0.05 2/101 7
  PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND
    1     0 root     S     3168   0%   0% /bin/sh -c top -b cmd cmd2
    7     1 root     R     3164   0%   0% top -b
</span></code></pre></div></div>

<p>You can see from the output of <code class="highlighter-rouge">top</code> that the specified <code class="highlighter-rouge">ENTRYPOINT</code> is not <code class="highlighter-rouge">PID 1</code>.</p>

<p>If you then run <code class="highlighter-rouge">docker stop test</code>, the container will not exit cleanly - the
<code class="highlighter-rouge">stop</code> command will be forced to send a <code class="highlighter-rouge">SIGKILL</code> after the timeout:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker <span class="nb">exec</span> <span class="nt">-it</span> <span class="nb">test </span>ps aux
<span class="go">
PID   USER     COMMAND
    1 root     /bin/sh -c top -b cmd cmd2
    7 root     top -b
    8 root     ps aux

</span><span class="gp">$</span> /usr/bin/time docker stop <span class="nb">test</span>
<span class="go">
test
real	0m 10.19s
user	0m 0.04s
sys	0m 0.03s
</span></code></pre></div></div>

<h3 id="understand-how-cmd-and-entrypoint-interact">Understand how CMD and ENTRYPOINT interact<a href="https://docs.docker.com/engine/reference/builder/#understand-how-cmd-and-entrypoint-interact" class="anchorLink">🔗</a></h3>

<p>Both <code class="highlighter-rouge">CMD</code> and <code class="highlighter-rouge">ENTRYPOINT</code> instructions define what command gets executed when running a container.
There are few rules that describe their co-operation.</p>

<ol>
  <li>
    <p>Dockerfile should specify at least one of <code class="highlighter-rouge">CMD</code> or <code class="highlighter-rouge">ENTRYPOINT</code> commands.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">ENTRYPOINT</code> should be defined when using the container as an executable.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">CMD</code> should be used as a way of defining default arguments for an <code class="highlighter-rouge">ENTRYPOINT</code> command
or for executing an ad-hoc command in a container.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">CMD</code> will be overridden when running the container with alternative arguments.</p>
  </li>
</ol>

<p>The table below shows what command is executed for different <code class="highlighter-rouge">ENTRYPOINT</code> / <code class="highlighter-rouge">CMD</code> combinations:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">&nbsp;</th>
      <th style="text-align: left">No ENTRYPOINT</th>
      <th style="text-align: left">ENTRYPOINT exec_entry p1_entry</th>
      <th style="text-align: left">ENTRYPOINT [“exec_entry”, “p1_entry”]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><strong>No CMD</strong></td>
      <td style="text-align: left"><em>error, not allowed</em></td>
      <td style="text-align: left">/bin/sh -c exec_entry p1_entry</td>
      <td style="text-align: left">exec_entry p1_entry</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>CMD [“exec_cmd”, “p1_cmd”]</strong></td>
      <td style="text-align: left">exec_cmd p1_cmd</td>
      <td style="text-align: left">/bin/sh -c exec_entry p1_entry</td>
      <td style="text-align: left">exec_entry p1_entry exec_cmd p1_cmd</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>CMD [“p1_cmd”, “p2_cmd”]</strong></td>
      <td style="text-align: left">p1_cmd p2_cmd</td>
      <td style="text-align: left">/bin/sh -c exec_entry p1_entry</td>
      <td style="text-align: left">exec_entry p1_entry p1_cmd p2_cmd</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>CMD exec_cmd p1_cmd</strong></td>
      <td style="text-align: left">/bin/sh -c exec_cmd p1_cmd</td>
      <td style="text-align: left">/bin/sh -c exec_entry p1_entry</td>
      <td style="text-align: left">exec_entry p1_entry /bin/sh -c exec_cmd p1_cmd</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><strong>Note</strong></p>

  <p>If <code class="highlighter-rouge">CMD</code> is defined from the base image, setting <code class="highlighter-rouge">ENTRYPOINT</code> will
reset <code class="highlighter-rouge">CMD</code> to an empty value. In this scenario, <code class="highlighter-rouge">CMD</code> must be defined in the
current image to have a value.</p>
</blockquote>

<h2 id="volume">VOLUME<a href="https://docs.docker.com/engine/reference/builder/#volume" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">VOLUME</span><span class="s"> ["/data"]</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">VOLUME</code> instruction creates a mount point with the specified name
and marks it as holding externally mounted volumes from native host or other
containers. The value can be a JSON array, <code class="highlighter-rouge">VOLUME ["/var/log/"]</code>, or a plain
string with multiple arguments, such as <code class="highlighter-rouge">VOLUME /var/log</code> or <code class="highlighter-rouge">VOLUME /var/log
/var/db</code>. For more information/examples and mounting instructions via the
Docker client, refer to
<a href="https://docs.docker.com/storage/volumes/"><em>Share Directories via Volumes</em></a>
documentation.</p>

<p>The <code class="highlighter-rouge">docker run</code> command initializes the newly created volume with any data
that exists at the specified location within the base image. For example,
consider the following Dockerfile snippet:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">RUN </span>mkdir /myvol
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo</span> <span class="s2">"hello world"</span> <span class="o">&gt;</span> /myvol/greeting
<span class="k" data-original-title="" title="">VOLUME</span><span class="s"> /myvol</span>
</code></pre></div></div>

<p>This Dockerfile results in an image that causes <code class="highlighter-rouge">docker run</code> to
create a new mount point at <code class="highlighter-rouge">/myvol</code> and copy the  <code class="highlighter-rouge">greeting</code> file
into the newly created volume.</p>

<h3 id="notes-about-specifying-volumes">Notes about specifying volumes<a href="https://docs.docker.com/engine/reference/builder/#notes-about-specifying-volumes" class="anchorLink">🔗</a></h3>

<p>Keep the following things in mind about volumes in the <code class="highlighter-rouge">Dockerfile</code>.</p>

<ul>
  <li>
    <p><strong>Volumes on Windows-based containers</strong>: When using Windows-based containers,
the destination of a volume inside the container must be one of:</p>

    <ul>
      <li>a non-existing or empty directory</li>
      <li>a drive other than <code class="highlighter-rouge">C:</code></li>
    </ul>
  </li>
  <li>
    <p><strong>Changing the volume from within the Dockerfile</strong>: If any build steps change the
data within the volume after it has been declared, those changes will be discarded.</p>
  </li>
  <li>
    <p><strong>JSON formatting</strong>: The list is parsed as a JSON array.
You must enclose words with double quotes (<code class="highlighter-rouge">"</code>) rather than single quotes (<code class="highlighter-rouge">'</code>).</p>
  </li>
  <li>
    <p><strong>The host directory is declared at container run-time</strong>: The host directory
(the mountpoint) is, by its nature, host-dependent. This is to preserve image
portability, since a given host directory can’t be guaranteed to be available
on all hosts. For this reason, you can’t mount a host directory from
within the Dockerfile. The <code class="highlighter-rouge">VOLUME</code> instruction does not support specifying a <code class="highlighter-rouge">host-dir</code>
parameter.  You must specify the mountpoint when you create or run the container.</p>
  </li>
</ul>

<h2 id="user">USER<a href="https://docs.docker.com/engine/reference/builder/#user" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">USER</span><span class="s"> &lt;user&gt;[:&lt;group&gt;]</span>
</code></pre></div></div>

<p>or</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">USER</span><span class="s"> &lt;UID&gt;[:&lt;GID&gt;]</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">USER</code> instruction sets the user name (or UID) and optionally the user
group (or GID) to use when running the image and for any <code class="highlighter-rouge">RUN</code>, <code class="highlighter-rouge">CMD</code> and
<code class="highlighter-rouge">ENTRYPOINT</code> instructions that follow it in the <code class="highlighter-rouge">Dockerfile</code>.</p>

<blockquote>
  <p>Note that when specifying a group for the user, the user will have <em>only</em> the
specified group membership. Any other configured group memberships will be ignored.</p>
</blockquote>

<blockquote>
  <p><strong>Warning</strong></p>

  <p>When the user doesn’t have a primary group then the image (or the next
instructions) will be run with the <code class="highlighter-rouge">root</code> group.</p>

  <p>On Windows, the user must be created first if it’s not a built-in account.
This can be done with the <code class="highlighter-rouge">net user</code> command called as part of a Dockerfile.</p>
</blockquote>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> microsoft/windowsservercore</span>
<span class="c"># Create Windows user in the container</span>
<span class="k" data-original-title="" title="">RUN </span>net user /add patrick
<span class="c"># Set it for subsequent commands</span>
<span class="k" data-original-title="" title="">USER</span><span class="s"> patrick</span>
</code></pre></div></div>

<h2 id="workdir">WORKDIR<a href="https://docs.docker.com/engine/reference/builder/#workdir" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">WORKDIR</span><span class="s"> /path/to/workdir</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">WORKDIR</code> instruction sets the working directory for any <code class="highlighter-rouge">RUN</code>, <code class="highlighter-rouge">CMD</code>,
<code class="highlighter-rouge">ENTRYPOINT</code>, <code class="highlighter-rouge">COPY</code> and <code class="highlighter-rouge">ADD</code> instructions that follow it in the <code class="highlighter-rouge">Dockerfile</code>.
If the <code class="highlighter-rouge">WORKDIR</code> doesn’t exist, it will be created even if it’s not used in any
subsequent <code class="highlighter-rouge">Dockerfile</code> instruction.</p>

<p>The <code class="highlighter-rouge">WORKDIR</code> instruction can be used multiple times in a <code class="highlighter-rouge">Dockerfile</code>. If a
relative path is provided, it will be relative to the path of the previous
<code class="highlighter-rouge">WORKDIR</code> instruction. For example:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">WORKDIR</span><span class="s"> /a</span>
<span class="k" data-original-title="" title="">WORKDIR</span><span class="s"> b</span>
<span class="k" data-original-title="" title="">WORKDIR</span><span class="s"> c</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">pwd</span>
</code></pre></div></div>

<p>The output of the final <code class="highlighter-rouge">pwd</code> command in this <code class="highlighter-rouge">Dockerfile</code> would be <code class="highlighter-rouge">/a/b/c</code>.</p>

<p>The <code class="highlighter-rouge">WORKDIR</code> instruction can resolve environment variables previously set using
<code class="highlighter-rouge">ENV</code>. You can only use environment variables explicitly set in the <code class="highlighter-rouge">Dockerfile</code>.
For example:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ENV</span><span class="s"> DIRPATH=/path</span>
<span class="k" data-original-title="" title="">WORKDIR</span><span class="s"> $DIRPATH/$DIRNAME</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">pwd</span>
</code></pre></div></div>

<p>The output of the final <code class="highlighter-rouge">pwd</code> command in this <code class="highlighter-rouge">Dockerfile</code> would be
<code class="highlighter-rouge">/path/$DIRNAME</code></p>

<h2 id="arg">ARG<a href="https://docs.docker.com/engine/reference/builder/#arg" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ARG</span><span class="s"> &lt;name&gt;[=&lt;default value&gt;]</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">ARG</code> instruction defines a variable that users can pass at build-time to
the builder with the <code class="highlighter-rouge">docker build</code> command using the <code class="highlighter-rouge">--build-arg &lt;varname&gt;=&lt;value&gt;</code>
flag. If a user specifies a build argument that was not
defined in the Dockerfile, the build outputs a warning.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">[Warning] One or more build-args [foo] were not consumed.
</span></code></pre></div></div>

<p>A Dockerfile may include one or more <code class="highlighter-rouge">ARG</code> instructions. For example,
the following is a valid Dockerfile:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> busybox</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> user1</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> buildno</span>
<span class="c"># ...</span>
</code></pre></div></div>

<blockquote class="warning">
  <p><strong>Warning:</strong></p>

  <p>It is not recommended to use build-time variables for passing secrets like
github keys, user credentials etc. Build-time variable values are visible to
any user of the image with the <code class="highlighter-rouge">docker history</code> command.</p>

  <p>Refer to the <a href="https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information">“build images with BuildKit”</a>
section to learn about secure ways to use secrets when building images.</p>
</blockquote>

<h3 id="default-values">Default values<a href="https://docs.docker.com/engine/reference/builder/#default-values" class="anchorLink">🔗</a></h3>

<p>An <code class="highlighter-rouge">ARG</code> instruction can optionally include a default value:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> busybox</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> user1=someuser</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> buildno=1</span>
<span class="c"># ...</span>
</code></pre></div></div>

<p>If an <code class="highlighter-rouge">ARG</code> instruction has a default value and if there is no value passed
at build-time, the builder uses the default.</p>

<h3 id="scope">Scope<a href="https://docs.docker.com/engine/reference/builder/#scope" class="anchorLink">🔗</a></h3>

<p>An <code class="highlighter-rouge">ARG</code> variable definition comes into effect from the line on which it is
defined in the <code class="highlighter-rouge">Dockerfile</code> not from the argument’s use on the command-line or
elsewhere.  For example, consider this Dockerfile:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> busybox</span>
<span class="k" data-original-title="" title="">USER</span><span class="s"> ${user:-some_user}</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> user</span>
<span class="k" data-original-title="" title="">USER</span><span class="s"> $user</span>
<span class="c"># ...</span>
</code></pre></div></div>

<p>A user builds this file by calling:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker build <span class="nt">--build-arg</span> <span class="nv">user</span><span class="o">=</span>what_user <span class="nb">.</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">USER</code> at line 2 evaluates to <code class="highlighter-rouge">some_user</code> as the <code class="highlighter-rouge">user</code> variable is defined on the
subsequent line 3. The <code class="highlighter-rouge">USER</code> at line 4 evaluates to <code class="highlighter-rouge">what_user</code> as <code class="highlighter-rouge">user</code> is
defined and the <code class="highlighter-rouge">what_user</code> value was passed on the command line. Prior to its definition by an
<code class="highlighter-rouge">ARG</code> instruction, any use of a variable results in an empty string.</p>

<p>An <code class="highlighter-rouge">ARG</code> instruction goes out of scope at the end of the build
stage where it was defined. To use an arg in multiple stages, each stage must
include the <code class="highlighter-rouge">ARG</code> instruction.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> busybox</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> SETTINGS</span>
<span class="k" data-original-title="" title="">RUN </span>./run/setup <span class="nv">$SETTINGS</span>

<span class="k" data-original-title="" title="">FROM</span><span class="s"> busybox</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> SETTINGS</span>
<span class="k" data-original-title="" title="">RUN </span>./run/other <span class="nv">$SETTINGS</span>
</code></pre></div></div>

<h3 id="using-arg-variables">Using ARG variables<a href="https://docs.docker.com/engine/reference/builder/#using-arg-variables" class="anchorLink">🔗</a></h3>

<p>You can use an <code class="highlighter-rouge">ARG</code> or an <code class="highlighter-rouge">ENV</code> instruction to specify variables that are
available to the <code class="highlighter-rouge">RUN</code> instruction. Environment variables defined using the
<code class="highlighter-rouge">ENV</code> instruction always override an <code class="highlighter-rouge">ARG</code> instruction of the same name. Consider
this Dockerfile with an <code class="highlighter-rouge">ENV</code> and <code class="highlighter-rouge">ARG</code> instruction.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> CONT_IMG_VER</span>
<span class="k" data-original-title="" title="">ENV</span><span class="s"> CONT_IMG_VER=v1.0.0</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo</span> <span class="nv">$CONT_IMG_VER</span>
</code></pre></div></div>

<p>Then, assume this image is built with this command:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker build <span class="nt">--build-arg</span> <span class="nv">CONT_IMG_VER</span><span class="o">=</span>v2.0.1 <span class="nb">.</span>
</code></pre></div></div>

<p>In this case, the <code class="highlighter-rouge">RUN</code> instruction uses <code class="highlighter-rouge">v1.0.0</code> instead of the <code class="highlighter-rouge">ARG</code> setting
passed by the user:<code class="highlighter-rouge">v2.0.1</code> This behavior is similar to a shell
script where a locally scoped variable overrides the variables passed as
arguments or inherited from environment, from its point of definition.</p>

<p>Using the example above but a different <code class="highlighter-rouge">ENV</code> specification you can create more
useful interactions between <code class="highlighter-rouge">ARG</code> and <code class="highlighter-rouge">ENV</code> instructions:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> CONT_IMG_VER</span>
<span class="k" data-original-title="" title="">ENV</span><span class="s"> CONT_IMG_VER=${CONT_IMG_VER:-v1.0.0}</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo</span> <span class="nv">$CONT_IMG_VER</span>
</code></pre></div></div>

<p>Unlike an <code class="highlighter-rouge">ARG</code> instruction, <code class="highlighter-rouge">ENV</code> values are always persisted in the built
image. Consider a docker build without the <code class="highlighter-rouge">--build-arg</code> flag:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker build <span class="nb">.</span>
</code></pre></div></div>

<p>Using this Dockerfile example, <code class="highlighter-rouge">CONT_IMG_VER</code> is still persisted in the image but
its value would be <code class="highlighter-rouge">v1.0.0</code> as it is the default set in line 3 by the <code class="highlighter-rouge">ENV</code> instruction.</p>

<p>The variable expansion technique in this example allows you to pass arguments
from the command line and persist them in the final image by leveraging the
<code class="highlighter-rouge">ENV</code> instruction. Variable expansion is only supported for <a href="https://docs.docker.com/engine/reference/builder/#environment-replacement">a limited set of
Dockerfile instructions.</a></p>

<h3 id="predefined-args">Predefined ARGs<a href="https://docs.docker.com/engine/reference/builder/#predefined-args" class="anchorLink">🔗</a></h3>

<p>Docker has a set of predefined <code class="highlighter-rouge">ARG</code> variables that you can use without a
corresponding <code class="highlighter-rouge">ARG</code> instruction in the Dockerfile.</p>

<ul>
  <li><code class="highlighter-rouge">HTTP_PROXY</code></li>
  <li><code class="highlighter-rouge">http_proxy</code></li>
  <li><code class="highlighter-rouge">HTTPS_PROXY</code></li>
  <li><code class="highlighter-rouge">https_proxy</code></li>
  <li><code class="highlighter-rouge">FTP_PROXY</code></li>
  <li><code class="highlighter-rouge">ftp_proxy</code></li>
  <li><code class="highlighter-rouge">NO_PROXY</code></li>
  <li><code class="highlighter-rouge">no_proxy</code></li>
</ul>

<p>To use these, pass them on the command line using the <code class="highlighter-rouge">--build-arg</code> flag, for
example:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker build <span class="nt">--build-arg</span> <span class="nv">HTTPS_PROXY</span><span class="o">=</span>https://my-proxy.example.com <span class="nb">.</span>
</code></pre></div></div>

<p>By default, these pre-defined variables are excluded from the output of
<code class="highlighter-rouge">docker history</code>. Excluding them reduces the risk of accidentally leaking
sensitive authentication information in an <code class="highlighter-rouge">HTTP_PROXY</code> variable.</p>

<p>For example, consider building the following Dockerfile using
<code class="highlighter-rouge">--build-arg HTTP_PROXY=http://user:pass@proxy.lon.example.com</code></p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo</span> <span class="s2">"Hello World"</span>
</code></pre></div></div>

<p>In this case, the value of the <code class="highlighter-rouge">HTTP_PROXY</code> variable is not available in the
<code class="highlighter-rouge">docker history</code> and is not cached. If you were to change location, and your
proxy server changed to <code class="highlighter-rouge">http://user:pass@proxy.sfo.example.com</code>, a subsequent
build does not result in a cache miss.</p>

<p>If you need to override this behaviour then you may do so by adding an <code class="highlighter-rouge">ARG</code>
statement in the Dockerfile as follows:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> HTTP_PROXY</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo</span> <span class="s2">"Hello World"</span>
</code></pre></div></div>

<p>When building this Dockerfile, the <code class="highlighter-rouge">HTTP_PROXY</code> is preserved in the
<code class="highlighter-rouge">docker history</code>, and changing its value invalidates the build cache.</p>

<h3 id="automatic-platform-args-in-the-global-scope">Automatic platform ARGs in the global scope<a href="https://docs.docker.com/engine/reference/builder/#automatic-platform-args-in-the-global-scope" class="anchorLink">🔗</a></h3>

<p>This feature is only available when using the <a href="https://docs.docker.com/engine/reference/builder/#buildkit">BuildKit</a> backend.</p>

<p>Docker predefines a set of <code class="highlighter-rouge">ARG</code> variables with information on the platform of
the node performing the build (build platform) and on the platform of the
resulting image (target platform). The target platform can be specified with
the <code class="highlighter-rouge">--platform</code> flag on <code class="highlighter-rouge">docker build</code>.</p>

<p>The following <code class="highlighter-rouge">ARG</code> variables are set automatically:</p>

<ul>
  <li><code class="highlighter-rouge">TARGETPLATFORM</code> - platform of the build result. Eg <code class="highlighter-rouge">linux/amd64</code>, <code class="highlighter-rouge">linux/arm/v7</code>, <code class="highlighter-rouge">windows/amd64</code>.</li>
  <li><code class="highlighter-rouge">TARGETOS</code> - OS component of TARGETPLATFORM</li>
  <li><code class="highlighter-rouge">TARGETARCH</code> - architecture component of TARGETPLATFORM</li>
  <li><code class="highlighter-rouge">TARGETVARIANT</code> - variant component of TARGETPLATFORM</li>
  <li><code class="highlighter-rouge">BUILDPLATFORM</code> - platform of the node performing the build.</li>
  <li><code class="highlighter-rouge">BUILDOS</code> - OS component of BUILDPLATFORM</li>
  <li><code class="highlighter-rouge">BUILDARCH</code> - architecture component of BUILDPLATFORM</li>
  <li><code class="highlighter-rouge">BUILDVARIANT</code> - variant component of BUILDPLATFORM</li>
</ul>

<p>These arguments are defined in the global scope so are not automatically
available inside build stages or for your <code class="highlighter-rouge">RUN</code> commands. To expose one of
these arguments inside the build stage redefine it without value.</p>

<p>For example:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> alpine</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> TARGETPLATFORM</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo</span> <span class="s2">"I'm building for </span><span class="nv">$TARGETPLATFORM</span><span class="s2">"</span>
</code></pre></div></div>

<h3 id="impact-on-build-caching">Impact on build caching<a href="https://docs.docker.com/engine/reference/builder/#impact-on-build-caching" class="anchorLink">🔗</a></h3>

<p><code class="highlighter-rouge">ARG</code> variables are not persisted into the built image as <code class="highlighter-rouge">ENV</code> variables are.
However, <code class="highlighter-rouge">ARG</code> variables do impact the build cache in similar ways. If a
Dockerfile defines an <code class="highlighter-rouge">ARG</code> variable whose value is different from a previous
build, then a “cache miss” occurs upon its first usage, not its definition. In
particular, all <code class="highlighter-rouge">RUN</code> instructions following an <code class="highlighter-rouge">ARG</code> instruction use the <code class="highlighter-rouge">ARG</code>
variable implicitly (as an environment variable), thus can cause a cache miss.
All predefined <code class="highlighter-rouge">ARG</code> variables are exempt from caching unless there is a
matching <code class="highlighter-rouge">ARG</code> statement in the <code class="highlighter-rouge">Dockerfile</code>.</p>

<p>For example, consider these two Dockerfile:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> CONT_IMG_VER</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo</span> <span class="nv">$CONT_IMG_VER</span>
</code></pre></div></div>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> CONT_IMG_VER</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo </span>hello
</code></pre></div></div>

<p>If you specify <code class="highlighter-rouge">--build-arg CONT_IMG_VER=&lt;value&gt;</code> on the command line, in both
cases, the specification on line 2 does not cause a cache miss; line 3 does
cause a cache miss.<code class="highlighter-rouge">ARG CONT_IMG_VER</code> causes the RUN line to be identified
as the same as running <code class="highlighter-rouge">CONT_IMG_VER=&lt;value&gt; echo hello</code>, so if the <code class="highlighter-rouge">&lt;value&gt;</code>
changes, we get a cache miss.</p>

<p>Consider another example under the same command line:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> CONT_IMG_VER</span>
<span class="k" data-original-title="" title="">ENV</span><span class="s"> CONT_IMG_VER=$CONT_IMG_VER</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo</span> <span class="nv">$CONT_IMG_VER</span>
</code></pre></div></div>

<p>In this example, the cache miss occurs on line 3. The miss happens because
the variable’s value in the <code class="highlighter-rouge">ENV</code> references the <code class="highlighter-rouge">ARG</code> variable and that
variable is changed through the command line. In this example, the <code class="highlighter-rouge">ENV</code>
command causes the image to include the value.</p>

<p>If an <code class="highlighter-rouge">ENV</code> instruction overrides an <code class="highlighter-rouge">ARG</code> instruction of the same name, like
this Dockerfile:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> ubuntu</span>
<span class="k" data-original-title="" title="">ARG</span><span class="s"> CONT_IMG_VER</span>
<span class="k" data-original-title="" title="">ENV</span><span class="s"> CONT_IMG_VER=hello</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo</span> <span class="nv">$CONT_IMG_VER</span>
</code></pre></div></div>

<p>Line 3 does not cause a cache miss because the value of <code class="highlighter-rouge">CONT_IMG_VER</code> is a
constant (<code class="highlighter-rouge">hello</code>). As a result, the environment variables and values used on
the <code class="highlighter-rouge">RUN</code> (line 4) doesn’t change between builds.</p>

<h2 id="onbuild">ONBUILD<a href="https://docs.docker.com/engine/reference/builder/#onbuild" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ONBUILD &lt;INSTRUCTION&gt;
</code></pre></div></div>

<p>The <code class="highlighter-rouge">ONBUILD</code> instruction adds to the image a <em>trigger</em> instruction to
be executed at a later time, when the image is used as the base for
another build. The trigger will be executed in the context of the
downstream build, as if it had been inserted immediately after the
<code class="highlighter-rouge">FROM</code> instruction in the downstream <code class="highlighter-rouge">Dockerfile</code>.</p>

<p>Any build instruction can be registered as a trigger.</p>

<p>This is useful if you are building an image which will be used as a base
to build other images, for example an application build environment or a
daemon which may be customized with user-specific configuration.</p>

<p>For example, if your image is a reusable Python application builder, it
will require application source code to be added in a particular
directory, and it might require a build script to be called <em>after</em>
that. You can’t just call <code class="highlighter-rouge">ADD</code> and <code class="highlighter-rouge">RUN</code> now, because you don’t yet
have access to the application source code, and it will be different for
each application build. You could simply provide application developers
with a boilerplate <code class="highlighter-rouge">Dockerfile</code> to copy-paste into their application, but
that is inefficient, error-prone and difficult to update because it
mixes with application-specific code.</p>

<p>The solution is to use <code class="highlighter-rouge">ONBUILD</code> to register advance instructions to
run later, during the next build stage.</p>

<p>Here’s how it works:</p>

<ol>
  <li>When it encounters an <code class="highlighter-rouge">ONBUILD</code> instruction, the builder adds a
trigger to the metadata of the image being built. The instruction
does not otherwise affect the current build.</li>
  <li>At the end of the build, a list of all triggers is stored in the
image manifest, under the key <code class="highlighter-rouge">OnBuild</code>. They can be inspected with
the <code class="highlighter-rouge">docker inspect</code> command.</li>
  <li>Later the image may be used as a base for a new build, using the
<code class="highlighter-rouge">FROM</code> instruction. As part of processing the <code class="highlighter-rouge">FROM</code> instruction,
the downstream builder looks for <code class="highlighter-rouge">ONBUILD</code> triggers, and executes
them in the same order they were registered. If any of the triggers
fail, the <code class="highlighter-rouge">FROM</code> instruction is aborted which in turn causes the
build to fail. If all triggers succeed, the <code class="highlighter-rouge">FROM</code> instruction
completes and the build continues as usual.</li>
  <li>Triggers are cleared from the final image after being executed. In
other words they are not inherited by “grand-children” builds.</li>
</ol>

<p>For example you might add something like this:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">ONBUILD</span><span class="w"> </span><span class="k" data-original-title="" title="">ADD</span><span class="s"> . /app/src</span>
<span class="k" data-original-title="" title="">ONBUILD RUN </span>/usr/local/bin/python-build <span class="nt">--dir</span> /app/src
</code></pre></div></div>

<blockquote>
  <p><strong>Warning</strong></p>

  <p>Chaining <code class="highlighter-rouge">ONBUILD</code> instructions using <code class="highlighter-rouge">ONBUILD ONBUILD</code> isn’t allowed.</p>
</blockquote>

<blockquote>
  <p><strong>Warning</strong></p>

  <p>The <code class="highlighter-rouge">ONBUILD</code> instruction may not trigger <code class="highlighter-rouge">FROM</code> or <code class="highlighter-rouge">MAINTAINER</code> instructions.</p>
</blockquote>

<h2 id="stopsignal">STOPSIGNAL<a href="https://docs.docker.com/engine/reference/builder/#stopsignal" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">STOPSIGNAL</span><span class="s"> signal</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">STOPSIGNAL</code> instruction sets the system call signal that will be sent to the
container to exit. This signal can be a signal name in the format <code class="highlighter-rouge">SIG&lt;NAME&gt;</code>,
for instance <code class="highlighter-rouge">SIGKILL</code>, or an unsigned number that matches a position in the
kernel’s syscall table, for instance <code class="highlighter-rouge">9</code>. The default is <code class="highlighter-rouge">SIGTERM</code> if not
defined.</p>

<p>The image’s default stopsignal can be overridden per container, using the
<code class="highlighter-rouge">--stop-signal</code> flag on <code class="highlighter-rouge">docker run</code> and <code class="highlighter-rouge">docker create</code>.</p>

<h2 id="healthcheck">HEALTHCHECK<a href="https://docs.docker.com/engine/reference/builder/#healthcheck" class="anchorLink">🔗</a></h2>

<p>The <code class="highlighter-rouge">HEALTHCHECK</code> instruction has two forms:</p>

<ul>
  <li><code class="highlighter-rouge">HEALTHCHECK [OPTIONS] CMD command</code> (check container health by running a command inside the container)</li>
  <li><code class="highlighter-rouge">HEALTHCHECK NONE</code> (disable any healthcheck inherited from the base image)</li>
</ul>

<p>The <code class="highlighter-rouge">HEALTHCHECK</code> instruction tells Docker how to test a container to check that
it is still working. This can detect cases such as a web server that is stuck in
an infinite loop and unable to handle new connections, even though the server
process is still running.</p>

<p>When a container has a healthcheck specified, it has a <em>health status</em> in
addition to its normal status. This status is initially <code class="highlighter-rouge">starting</code>. Whenever a
health check passes, it becomes <code class="highlighter-rouge">healthy</code> (whatever state it was previously in).
After a certain number of consecutive failures, it becomes <code class="highlighter-rouge">unhealthy</code>.</p>

<p>The options that can appear before <code class="highlighter-rouge">CMD</code> are:</p>

<ul>
  <li><code class="highlighter-rouge">--interval=DURATION</code> (default: <code class="highlighter-rouge">30s</code>)</li>
  <li><code class="highlighter-rouge">--timeout=DURATION</code> (default: <code class="highlighter-rouge">30s</code>)</li>
  <li><code class="highlighter-rouge">--start-period=DURATION</code> (default: <code class="highlighter-rouge">0s</code>)</li>
  <li><code class="highlighter-rouge">--retries=N</code> (default: <code class="highlighter-rouge">3</code>)</li>
</ul>

<p>The health check will first run <strong>interval</strong> seconds after the container is
started, and then again <strong>interval</strong> seconds after each previous check completes.</p>

<p>If a single run of the check takes longer than <strong>timeout</strong> seconds then the check
is considered to have failed.</p>

<p>It takes <strong>retries</strong> consecutive failures of the health check for the container
to be considered <code class="highlighter-rouge">unhealthy</code>.</p>

<p><strong>start period</strong> provides initialization time for containers that need time to bootstrap.
Probe failure during that period will not be counted towards the maximum number of retries.
However, if a health check succeeds during the start period, the container is considered
started and all consecutive failures will be counted towards the maximum number of retries.</p>

<p>There can only be one <code class="highlighter-rouge">HEALTHCHECK</code> instruction in a Dockerfile. If you list
more than one then only the last <code class="highlighter-rouge">HEALTHCHECK</code> will take effect.</p>

<p>The command after the <code class="highlighter-rouge">CMD</code> keyword can be either a shell command (e.g. <code class="highlighter-rouge">HEALTHCHECK
CMD /bin/check-running</code>) or an <em>exec</em> array (as with other Dockerfile commands;
see e.g. <code class="highlighter-rouge">ENTRYPOINT</code> for details).</p>

<p>The command’s exit status indicates the health status of the container.
The possible values are:</p>

<ul>
  <li>0: success - the container is healthy and ready for use</li>
  <li>1: unhealthy - the container is not working correctly</li>
  <li>2: reserved - do not use this exit code</li>
</ul>

<p>For example, to check every five minutes or so that a web-server is able to
serve the site’s main page within three seconds:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">HEALTHCHECK</span><span class="s"> --interval=5m --timeout=3s \</span>
  CMD curl -f http://localhost/ || exit 1
</code></pre></div></div>

<p>To help debug failing probes, any output text (UTF-8 encoded) that the command writes
on stdout or stderr will be stored in the health status and can be queried with
<code class="highlighter-rouge">docker inspect</code>. Such output should be kept short (only the first 4096 bytes
are stored currently).</p>

<p>When the health status of a container changes, a <code class="highlighter-rouge">health_status</code> event is
generated with the new status.</p>

<h2 id="shell">SHELL<a href="https://docs.docker.com/engine/reference/builder/#shell" class="anchorLink">🔗</a></h2>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">SHELL</span><span class="s"> ["executable", "parameters"]</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">SHELL</code> instruction allows the default shell used for the <em>shell</em> form of
commands to be overridden. The default shell on Linux is <code class="highlighter-rouge">["/bin/sh", "-c"]</code>, and on
Windows is <code class="highlighter-rouge">["cmd", "/S", "/C"]</code>. The <code class="highlighter-rouge">SHELL</code> instruction <em>must</em> be written in JSON
form in a Dockerfile.</p>

<p>The <code class="highlighter-rouge">SHELL</code> instruction is particularly useful on Windows where there are
two commonly used and quite different native shells: <code class="highlighter-rouge">cmd</code> and <code class="highlighter-rouge">powershell</code>, as
well as alternate shells available including <code class="highlighter-rouge">sh</code>.</p>

<p>The <code class="highlighter-rouge">SHELL</code> instruction can appear multiple times. Each <code class="highlighter-rouge">SHELL</code> instruction overrides
all previous <code class="highlighter-rouge">SHELL</code> instructions, and affects all subsequent instructions. For example:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">FROM</span><span class="s"> microsoft/windowsservercore</span>

<span class="c"># Executed as cmd /S /C echo default</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo </span>default

<span class="c"># Executed as cmd /S /C powershell -command Write-Host default</span>
<span class="k" data-original-title="" title="">RUN </span>powershell <span class="nt">-command</span> Write-Host default

<span class="c"># Executed as powershell -command Write-Host hello</span>
<span class="k" data-original-title="" title="">SHELL</span><span class="s"> ["powershell", "-command"]</span>
<span class="k" data-original-title="" title="">RUN </span>Write-Host hello

<span class="c"># Executed as cmd /S /C echo hello</span>
<span class="k" data-original-title="" title="">SHELL</span><span class="s"> ["cmd", "/S", "/C"]</span>
<span class="k" data-original-title="" title="">RUN </span><span class="nb">echo </span>hello
</code></pre></div></div>

<p>The following instructions can be affected by the <code class="highlighter-rouge">SHELL</code> instruction when the
<em>shell</em> form of them is used in a Dockerfile: <code class="highlighter-rouge">RUN</code>, <code class="highlighter-rouge">CMD</code> and <code class="highlighter-rouge">ENTRYPOINT</code>.</p>

<p>The following example is a common pattern found on Windows which can be
streamlined by using the <code class="highlighter-rouge">SHELL</code> instruction:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">RUN </span>powershell <span class="nt">-command</span> Execute-MyCmdlet <span class="nt">-param1</span> <span class="s2">"c:</span><span class="se">\f</span><span class="s2">oo.txt"</span>
</code></pre></div></div>

<p>The command invoked by docker will be:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cmd /S /C powershell -command Execute-MyCmdlet -param1 <span class="s2">"c:\foo.txt"</span>
</code></pre></div></div>

<p>This is inefficient for two reasons. First, there is an un-necessary cmd.exe command
processor (aka shell) being invoked. Second, each <code class="highlighter-rouge">RUN</code> instruction in the <em>shell</em>
form requires an extra <code class="highlighter-rouge">powershell -command</code> prefixing the command.</p>

<p>To make this more efficient, one of two mechanisms can be employed. One is to
use the JSON form of the RUN command such as:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k" data-original-title="" title="">RUN </span><span class="o">[</span><span class="s2">"powershell"</span>, <span class="s2">"-command"</span>, <span class="s2">"Execute-MyCmdlet"</span>, <span class="s2">"-param1 </span><span class="se">\"</span><span class="s2">c:</span><span class="se">\\</span><span class="s2">foo.txt</span><span class="se">\"</span><span class="s2">"</span><span class="o">]</span>
</code></pre></div></div>

<p>While the JSON form is unambiguous and does not use the un-necessary cmd.exe,
it does require more verbosity through double-quoting and escaping. The alternate
mechanism is to use the <code class="highlighter-rouge">SHELL</code> instruction and the <em>shell</em> form,
making a more natural syntax for Windows users, especially when combined with
the <code class="highlighter-rouge">escape</code> parser directive:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># escape=`</span>

<span class="k" data-original-title="" title="">FROM</span><span class="s"> microsoft/nanoserver</span>
<span class="k" data-original-title="" title="">SHELL</span><span class="s"> ["powershell","-command"]</span>
<span class="k" data-original-title="" title="">RUN </span>New-Item <span class="nt">-ItemType</span> Directory C:<span class="se">\E</span>xample
<span class="k" data-original-title="" title="">ADD</span><span class="s"> Execute-MyCmdlet.ps1 c:\example\</span>
<span class="k" data-original-title="" title="">RUN </span>c:<span class="se">\e</span>xample<span class="se">\E</span>xecute-MyCmdlet <span class="nt">-sample</span> <span class="s1">'hello world'</span>
</code></pre></div></div>

<p>Resulting in:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">PS E:\myproject&gt;</span> docker build <span class="nt">-t</span> shell <span class="nb">.</span>
<span class="go">
Sending build context to Docker daemon 4.096 kB
Step 1/5 : FROM microsoft/nanoserver
</span><span class="gp"> ---&gt;</span> 22738ff49c6d
<span class="go">Step 2/5 : SHELL powershell -command
</span><span class="gp"> ---&gt;</span> Running <span class="k">in </span>6fcdb6855ae2
<span class="gp"> ---&gt;</span> 6331462d4300
<span class="go">Removing intermediate container 6fcdb6855ae2
Step 3/5 : RUN New-Item -ItemType Directory C:\Example
</span><span class="gp"> ---&gt;</span> Running <span class="k">in </span>d0eef8386e97
<span class="go">

    Directory: C:\


Mode         LastWriteTime              Length Name
----         -------------              ------ ----
d-----       10/28/2016  11:26 AM              Example


</span><span class="gp"> ---&gt;</span> 3f2fbf1395d9
<span class="go">Removing intermediate container d0eef8386e97
</span><span class="gp">Step 4/5 : ADD Execute-MyCmdlet.ps1 c:\example\
 ---&gt;</span> a955b2621c31
<span class="go">Removing intermediate container b825593d39fc
Step 5/5 : RUN c:\example\Execute-MyCmdlet 'hello world'
</span><span class="gp"> ---&gt;</span> Running <span class="k">in </span>be6d8e63fe75
<span class="go">hello world
</span><span class="gp"> ---&gt;</span> 8e559e9bf424
<span class="go">Removing intermediate container be6d8e63fe75
Successfully built 8e559e9bf424
</span><span class="gp">PS E:\myproject&gt;</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">SHELL</code> instruction could also be used to modify the way in which
a shell operates. For example, using <code class="highlighter-rouge">SHELL cmd /S /C /V:ON|OFF</code> on Windows, delayed
environment variable expansion semantics could be modified.</p>

<p>The <code class="highlighter-rouge">SHELL</code> instruction can also be used on Linux should an alternate shell be
required such as <code class="highlighter-rouge">zsh</code>, <code class="highlighter-rouge">csh</code>, <code class="highlighter-rouge">tcsh</code> and others.</p>

<h2 id="dockerfile-examples">Dockerfile examples<a href="https://docs.docker.com/engine/reference/builder/#dockerfile-examples" class="anchorLink">🔗</a></h2>

<p>For examples of Dockerfiles, refer to:</p>

<ul>
  <li>The <a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">“build images” section</a></li>
  <li>The <a href="https://docs.docker.com/get-started/">“get started</a></li>
  <li>The <a href="https://docs.docker.com/language/">language-specific getting started guides</a></li>
</ul>
<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="https://docs.docker.com/search/?q=builder">builder</a>, <a href="https://docs.docker.com/search/?q=docker">docker</a>, <a href="https://docs.docker.com/search/?q=Dockerfile">Dockerfile</a>, <a href="https://docs.docker.com/search/?q=automation">automation</a>, <a href="https://docs.docker.com/search/?q=image%20creation">image creation</a></span><div class="ratings-div"><div id="pd_rating_holder_8453675" style="display: inline-block;"><div class="rating-msg" id="PDRTJS_8453675_msg" style="text-align: center; font:normal normal 12px/20px verdana; color: #333333;">Rate this page:</div><p style="padding: 0px; margin: 0px; clear: both;"></p><div class="rating-icons" id="pd_rate_8453675" style="float:left;"><div class="rating-nero-icon" onmouseout="PDRTJS_8453675.rebuild();" onclick="PDRTJS_8453675.rate(1);" onmouseover="PDRTJS_8453675.hover(1);" id="PDRTJS_8453675_nero_1" style="background-size: 32px 32px !important; cursor: pointer; width: 16px; height: 16px;  line-height: 16px; background: url(https://polldaddy.com/images/ratings/nero-hand-sml@2x.png) bottom left; float: left; padding: 0px; margin: 0px; margin: 0px;">&nbsp;</div><div class="rating-nero-value" id="PDRTJS_8453675_msg_1" style="text-align: center; font:normal normal 12px/20px verdana; color: #333333; float:left; padding: 0px 4px;">1545</div><div class="rating-nero-icon" onmouseout="PDRTJS_8453675.rebuild();" onclick="PDRTJS_8453675.rate(2);" onmouseover="PDRTJS_8453675.hover(2);" id="PDRTJS_8453675_nero_2" style="background-size: 32px 32px !important; cursor: pointer; width: 16px; height: 16px;  line-height: 16px; background: url(https://polldaddy.com/images/ratings/nero-hand-sml@2x.png) bottom right; float: left; padding: 0px; margin: 0px; margin: 0px;">&nbsp;</div><div class="rating-nero-value" id="PDRTJS_8453675_msg_2" style="text-align: center; font:normal normal 12px/20px verdana; color: #333333; float:left; padding: 0px 4px;">415</div></div><span style="float:left;">&nbsp;</span><div id="rating_info_8453675" style="display: block; float: left; background: url(&quot;https://polldaddy.com/images/ratings/info@2x.png&quot;) 3px 2px / 12px 12px no-repeat; width: 16px; height: 16px; cursor: pointer;" onclick="javascript:PDRTJS_8453675.togglePopup();return false;"><span style="display:none;">i</span></div><div class="pd_popup_holder" id="pd_popup_holder_8453675">&nbsp;</div></div></div></section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                            <div id="navbar" class="nav-sidebar">
                                <ul class="nav hidden-md hidden-lg"></ul>
                                <ul class="nav" id="jsTOCLeftNav"><li><a href="https://docs.docker.com/reference/">Reference documentation</a></li><li><a onclick="navClicked(2)" data-target="#item2" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">Command-line reference<span class="caret arrow"></span></a><ul class="nav collapse" id="#item2" aria-expanded="false"><li><a onclick="navClicked(3)" data-target="#item3" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">Docker CLI (docker)<span class="caret arrow"></span></a><ul class="nav collapse" id="#item3" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/run/">Docker run reference</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/cli/">Use the Docker command line</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/docker/">docker (base command)</a></li><li><a onclick="navClicked(7)" data-target="#item7" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker app<span class="caret arrow"></span></a><ul class="nav collapse" id="#item7" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/app/">docker app</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_bundle/">docker app bundle</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_completion/">docker app completion</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_init/">docker app init</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_inspect/">docker app inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_install/">docker app install</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_list/">docker app list</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_pull/">docker app pull</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_push/">docker app push</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_render/">docker app render</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_status/">docker app status</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_uninstall/">docker app uninstall</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_upgrade/">docker app upgrade</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_validate/">docker app validate</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/app_version/">docker app version</a></li></ul></li><li><a href="https://docs.docker.com/engine/reference/commandline/attach/">docker attach</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/build/">docker build</a></li><li><a onclick="navClicked(25)" data-target="#item25" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker builder<span class="caret arrow"></span></a><ul class="nav collapse" id="#item25" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/builder/">docker builder</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/builder_build/">docker builder build</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/builder_prune/">docker builder prune</a></li></ul></li><li><a onclick="navClicked(29)" data-target="#item29" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker buildx<span class="caret arrow"></span></a><ul class="nav collapse" id="#item29" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/buildx/">docker buildx</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_bake/">docker buildx bake</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_build/">docker buildx build</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_create/">docker buildx create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_du/">docker buildx du</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_imagetools/">docker buildx imagetools</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_imagetools_create/">docker buildx imagetools create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_imagetools_inspect/">docker buildx imagetools inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_inspect/">docker buildx inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_install/">docker buildx install</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_ls/">docker buildx ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_prune/">docker buildx prune</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_rm/">docker buildx rm</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_stop/">docker buildx stop</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_uninstall/">docker buildx uninstall</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_use/">docker buildx use</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/buildx_version/">docker buildx version</a></li></ul></li><li><a onclick="navClicked(47)" data-target="#item47" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker checkpoint<span class="caret arrow"></span></a><ul class="nav collapse" id="#item47" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/checkpoint/">docker checkpoint</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/checkpoint_create/">docker checkpoint create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/checkpoint_ls/">docker checkpoint ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/checkpoint_rm/">docker checkpoint rm</a></li></ul></li><li><a href="https://docs.docker.com/engine/reference/commandline/commit/">docker commit</a></li><li><a onclick="navClicked(53)" data-target="#item53" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker compose<span class="caret arrow"></span></a><ul class="nav collapse" id="#item53" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/compose/">docker compose</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_build/">docker compose build</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_convert/">docker compose convert</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_cp/">docker compose cp</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_create/">docker compose create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_down/">docker compose down</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_events/">docker compose events</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_exec/">docker compose exec</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_images/">docker compose images</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_kill/">docker compose kill</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_logs/">docker compose logs</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_ls/">docker compose ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_pause/">docker compose pause</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_port/">docker compose port</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_ps/">docker compose ps</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_pull/">docker compose pull</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_push/">docker compose push</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_restart/">docker compose restart</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_rm/">docker compose rm</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_run/">docker compose run</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_start/">docker compose start</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_stop/">docker compose stop</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_top/">docker compose top</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_unpause/">docker compose unpause</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_up/">docker compose up</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/compose_version/">docker compose version</a></li></ul></li><li><a onclick="navClicked(80)" data-target="#item80" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker config<span class="caret arrow"></span></a><ul class="nav collapse" id="#item80" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/config/">docker config</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/config_create/">docker config create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/config_inspect/">docker config inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/config_ls/">docker config ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/config_rm/">docker config rm</a></li></ul></li><li><a onclick="navClicked(86)" data-target="#item86" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker container<span class="caret arrow"></span></a><ul class="nav collapse" id="#item86" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/container/">docker container</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_attach/">docker container attach</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_commit/">docker container commit</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_cp/">docker container cp</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_create/">docker container create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_diff/">docker container diff</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_exec/">docker container exec</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_export/">docker container export</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_inspect/">docker container inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_kill/">docker container kill</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_logs/">docker container logs</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_ls/">docker container ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_pause/">docker container pause</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_port/">docker container port</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_prune/">docker container prune</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_rename/">docker container rename</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_restart/">docker container restart</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_rm/">docker container rm</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_run/">docker container run</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_start/">docker container start</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_stats/">docker container stats</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_stop/">docker container stop</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_top/">docker container top</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_unpause/">docker container unpause</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_update/">docker container update</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/container_wait/">docker container wait</a></li></ul></li><li><a onclick="navClicked(113)" data-target="#item113" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker context<span class="caret arrow"></span></a><ul class="nav collapse" id="#item113" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/context/">docker context</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/context_create/">docker context create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/context_export/">docker context export</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/context_import/">docker context import</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/context_inspect/">docker context inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/context_ls/">docker context ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/context_rm/">docker context rm</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/context_update/">docker context update</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/context_use/">docker context use</a></li></ul></li><li><a href="https://docs.docker.com/engine/reference/commandline/cp/">docker cp</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/create/">docker create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/diff/">docker diff</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/events/">docker events</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/exec/">docker exec</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/export/">docker export</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/history/">docker history</a></li><li><a onclick="navClicked(130)" data-target="#item130" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker image<span class="caret arrow"></span></a><ul class="nav collapse" id="#item130" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/image/">docker image</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/image_build/">docker image build</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/image_history/">docker image history</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/image_import/">docker image import</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/image_inspect/">docker image inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/image_load/">docker image load</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/image_ls/">docker image ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/image_prune/">docker image prune</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/image_pull/">docker image pull</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/image_push/">docker image push</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/image_rm/">docker image rm</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/image_save/">docker image save</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/image_tag/">docker image tag</a></li></ul></li><li><a href="https://docs.docker.com/engine/reference/commandline/images/">docker images</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/import/">docker import</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/info/">docker info</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/inspect/">docker inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/kill/">docker kill</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/load/">docker load</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/login/">docker login</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/logout/">docker logout</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/logs/">docker logs</a></li><li><a onclick="navClicked(153)" data-target="#item153" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker manifest<span class="caret arrow"></span></a><ul class="nav collapse" id="#item153" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/manifest/">docker manifest</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/manifest_annotate/">docker manifest annotate</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/manifest_create/">docker manifest create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/manifest_inspect/">docker manifest inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/manifest_push/">docker manifest push</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/manifest_rm/">docker manifest rm</a></li></ul></li><li><a onclick="navClicked(160)" data-target="#item160" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker network<span class="caret arrow"></span></a><ul class="nav collapse" id="#item160" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/network/">docker network</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/network_connect/">docker network connect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/network_create/">docker network create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/network_disconnect/">docker network disconnect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/network_inspect/">docker network inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/network_ls/">docker network ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/network_prune/">docker network prune</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/network_rm/">docker network rm</a></li></ul></li><li><a onclick="navClicked(169)" data-target="#item169" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker node<span class="caret arrow"></span></a><ul class="nav collapse" id="#item169" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/node/">docker node</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/node_demote/">docker node demote</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/node_inspect/">docker node inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/node_ls/">docker node ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/node_promote/">docker node promote</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/node_ps/">docker node ps</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/node_rm/">docker node rm</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/node_update/">docker node update</a></li></ul></li><li><a href="https://docs.docker.com/engine/reference/commandline/pause/">docker pause</a></li><li><a onclick="navClicked(179)" data-target="#item179" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker plugin<span class="caret arrow"></span></a><ul class="nav collapse" id="#item179" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/plugin/">docker plugin</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/plugin_create/">docker plugin create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/plugin_disable/">docker plugin disable</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/plugin_enable/">docker plugin enable</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/plugin_inspect/">docker plugin inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/plugin_install/">docker plugin install</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/plugin_ls/">docker plugin ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/plugin_rm/">docker plugin rm</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/plugin_set/">docker plugin set</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/plugin_upgrade/">docker plugin upgrade</a></li></ul></li><li><a href="https://docs.docker.com/engine/reference/commandline/port/">docker port</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/ps/">docker ps</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/pull/">docker pull</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/push/">docker push</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/rename/">docker rename</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/restart/">docker restart</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/rm/">docker rm</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/rmi/">docker rmi</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/run/">docker run</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/save/">docker save</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/search/">docker search</a></li><li><a onclick="navClicked(201)" data-target="#item201" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker secret<span class="caret arrow"></span></a><ul class="nav collapse" id="#item201" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/secret/">docker secret</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/secret_create/">docker secret create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/secret_inspect/">docker secret inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/secret_ls/">docker secret ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/secret_rm/">docker secret rm</a></li></ul></li><li><a onclick="navClicked(207)" data-target="#item207" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker service<span class="caret arrow"></span></a><ul class="nav collapse" id="#item207" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/service/">docker service</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/service_create/">docker service create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/service_inspect/">docker service inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/service_logs/">docker service logs</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/service_ls/">docker service ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/service_ps/">docker service ps</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/service_rollback/">docker service rollback</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/service_rm/">docker service rm</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/service_scale/">docker service scale</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/service_update/">docker service update</a></li></ul></li><li><a onclick="navClicked(218)" data-target="#item218" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker stack<span class="caret arrow"></span></a><ul class="nav collapse" id="#item218" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/stack/">docker stack</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/stack_deploy/">docker stack deploy</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/stack_ls/">docker stack ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/stack_ps/">docker stack ps</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/stack_rm/">docker stack rm</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/stack_services/">docker stack services</a></li></ul></li><li><a href="https://docs.docker.com/engine/reference/commandline/start/">docker start</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/stats/">docker stats</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/stop/">docker stop</a></li><li><a onclick="navClicked(228)" data-target="#item228" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker swarm<span class="caret arrow"></span></a><ul class="nav collapse" id="#item228" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/swarm/">docker swarm</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/swarm_ca/">docker swarm ca</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/swarm_init/">docker swarm init</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/swarm_join-token/">docker swarm join-token</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/swarm_join/">docker swarm join</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/swarm_leave/">docker swarm leave</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/swarm_unlock-key/">docker swarm unlock-key</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/swarm_unlock/">docker swarm unlock</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/swarm_update/">docker swarm update</a></li></ul></li><li><a onclick="navClicked(238)" data-target="#item238" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker system<span class="caret arrow"></span></a><ul class="nav collapse" id="#item238" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/system/">docker system</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/system_df/">docker system df</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/system_events/">docker system events</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/system_info/">docker system info</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/system_prune/">docker system prune</a></li></ul></li><li><a href="https://docs.docker.com/engine/reference/commandline/tag/">docker tag</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/top/">docker top</a></li><li><a onclick="navClicked(246)" data-target="#item246" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker trust<span class="caret arrow"></span></a><ul class="nav collapse" id="#item246" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/trust/">docker trust</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/trust_inspect/">docker trust inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/trust_key/">docker trust key</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/trust_key_generate/">docker trust key generate</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/trust_key_load/">docker trust key load</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/trust_revoke/">docker trust revoke</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/trust_sign/">docker trust sign</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/trust_signer/">docker trust signer</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/trust_signer_add/">docker trust signer add</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/trust_signer_remove/">docker trust signer remove</a></li></ul></li><li><a href="https://docs.docker.com/engine/reference/commandline/unpause/">docker unpause</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/update/">docker update</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/version/">docker version</a></li><li><a onclick="navClicked(260)" data-target="#item260" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">docker volume<span class="caret arrow"></span></a><ul class="nav collapse" id="#item260" aria-expanded="false"><li><a href="https://docs.docker.com/engine/reference/commandline/volume_create/">docker volume create</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/volume_inspect/">docker volume inspect</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/volume_ls/">docker volume ls</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/volume_prune/">docker volume prune</a></li><li><a href="https://docs.docker.com/engine/reference/commandline/volume_rm/">docker volume rm</a></li></ul></li><li><a href="https://docs.docker.com/engine/reference/commandline/wait/">docker wait</a></li></ul></li><li><a onclick="navClicked(267)" data-target="#item267" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">Docker Compose CLI reference<span class="caret arrow"></span></a><ul class="nav collapse" id="#item267" aria-expanded="false"><li><a href="https://docs.docker.com/compose/reference/">Overview of docker-compose CLI</a></li><li><a href="https://docs.docker.com/compose/reference/envvars/">CLI environment variables</a></li><li><a href="https://docs.docker.com/compose/completion/">Command-line completion</a></li><li><a href="https://docs.docker.com/compose/reference/build/">docker-compose build</a></li><li><a href="https://docs.docker.com/compose/reference/config/">docker-compose config</a></li><li><a href="https://docs.docker.com/compose/reference/create/">docker-compose create</a></li><li><a href="https://docs.docker.com/compose/reference/down/">docker-compose down</a></li><li><a href="https://docs.docker.com/compose/reference/events/">docker-compose events</a></li><li><a href="https://docs.docker.com/compose/reference/exec/">docker-compose exec</a></li><li><a href="https://docs.docker.com/compose/reference/help/">docker-compose help</a></li><li><a href="https://docs.docker.com/compose/reference/images/">docker-compose images</a></li><li><a href="https://docs.docker.com/compose/reference/kill/">docker-compose kill</a></li><li><a href="https://docs.docker.com/compose/reference/logs/">docker-compose logs</a></li><li><a href="https://docs.docker.com/compose/reference/pause/">docker-compose pause</a></li><li><a href="https://docs.docker.com/compose/reference/port/">docker-compose port</a></li><li><a href="https://docs.docker.com/compose/reference/ps/">docker-compose ps</a></li><li><a href="https://docs.docker.com/compose/reference/pull/">docker-compose pull</a></li><li><a href="https://docs.docker.com/compose/reference/push/">docker-compose push</a></li><li><a href="https://docs.docker.com/compose/reference/restart/">docker-compose restart</a></li><li><a href="https://docs.docker.com/compose/reference/rm/">docker-compose rm</a></li><li><a href="https://docs.docker.com/compose/reference/run/">docker-compose run</a></li><li><a href="https://docs.docker.com/compose/reference/scale/">docker-compose scale</a></li><li><a href="https://docs.docker.com/compose/reference/start/">docker-compose start</a></li><li><a href="https://docs.docker.com/compose/reference/stop/">docker-compose stop</a></li><li><a href="https://docs.docker.com/compose/reference/top/">docker-compose top</a></li><li><a href="https://docs.docker.com/compose/reference/unpause/">docker-compose unpause</a></li><li><a href="https://docs.docker.com/compose/reference/up/">docker-compose up</a></li></ul></li><li><a href="https://docs.docker.com/engine/reference/commandline/dockerd/">Daemon CLI (dockerd)</a></li></ul></li><li><a onclick="navClicked(296)" data-target="#item296" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">API reference<span class="caret arrow"></span></a><ul class="nav collapse" id="#item296" aria-expanded="false"><li><a onclick="navClicked(297)" data-target="#item297" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">Docker Engine API<span class="caret arrow"></span></a><ul class="nav collapse" id="#item297" aria-expanded="false"><li><a href="https://docs.docker.com/engine/api/">Overview</a></li><li><a href="https://docs.docker.com/engine/api/sdk/">SDKs</a></li><li><a href="https://docs.docker.com/engine/api/sdk/examples/">SDK examples</a></li><li><a href="https://docs.docker.com/engine/api/latest/">v1.41 reference (latest)</a></li><li><a onclick="navClicked(302)" data-target="#item302" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">API reference by version<span class="caret arrow"></span></a><ul class="nav collapse" id="#item302" aria-expanded="false"><li><a href="https://docs.docker.com/engine/api/version-history/">Version history overview</a></li><li><a href="https://docs.docker.com/engine/api/v1.41/">v1.41 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.40/">v1.40 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.39/">v1.39 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.38/">v1.38 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.37/">v1.37 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.36/">v1.36 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.35/">v1.35 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.34/">v1.34 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.33/">v1.33 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.32/">v1.32 Reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.31/">v1.31 Reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.30/">v1.30 Reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.29/">v1.29 Reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.28/">v1.28 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.27/">v1.27 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.26/">v1.26 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.25/">v1.25 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.24/">v1.24 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.23/">v1.23 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.22/">v1.22 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.21/">v1.21 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.20/">v1.20 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.19/">v1.19 reference</a></li><li><a href="https://docs.docker.com/engine/api/v1.18/">v1.18 reference</a></li></ul></li></ul></li><li><a href="https://docs.docker.com/docker-hub/api/latest/">Docker Hub API</a></li><li><a href="https://docs.docker.com/registry/spec/api/">Registry API</a></li></ul></li><li><a href="https://docs.docker.com/engine/reference/builder/" class="active currentPage">Dockerfile reference</a></li><li><a onclick="navClicked(331)" data-target="#item331" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">Compose file reference<span class="caret arrow"></span></a><ul class="nav collapse" id="#item331" aria-expanded="false"><li><a href="https://docs.docker.com/compose/compose-file/">Compose Specification</a></li><li><a href="https://docs.docker.com/compose/compose-file/compose-file-v3/">Version 3</a></li><li><a href="https://docs.docker.com/compose/compose-file/compose-file-v2/">Version 2</a></li><li><a href="https://docs.docker.com/compose/compose-file/compose-versioning/">About versions and upgrading</a></li><li><a href="https://docs.docker.com/compose/faq/">Frequently asked questions</a></li></ul></li><li><a onclick="navClicked(337)" data-target="#item337" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">Drivers and specifications<span class="caret arrow"></span></a><ul class="nav collapse" id="#item337" aria-expanded="false"><li><a onclick="navClicked(338)" data-target="#item338" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">Registry image manifests<span class="caret arrow"></span></a><ul class="nav collapse" id="#item338" aria-expanded="false"><li><a href="https://docs.docker.com/registry/spec/manifest-v2-1/">Image manifest v 2, schema 1</a></li><li><a href="https://docs.docker.com/registry/spec/manifest-v2-2/">Image manifest v 2, schema 2</a></li><li><a href="https://docs.docker.com/registry/spec/deprecated-schema-v1/">Update deprecated schema v1 images</a></li></ul></li><li><a onclick="navClicked(342)" data-target="#item342" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">Registry token authorization<span class="caret arrow"></span></a><ul class="nav collapse" id="#item342" aria-expanded="false"><li><a href="https://docs.docker.com/registry/spec/auth/">Docker Registry token authentication</a></li><li><a href="https://docs.docker.com/registry/spec/auth/jwt/">Token authentication implementation</a></li><li><a href="https://docs.docker.com/registry/spec/auth/oauth/">Oauth2 token authentication</a></li><li><a href="https://docs.docker.com/registry/spec/auth/scope/">Token scope documentation</a></li><li><a href="https://docs.docker.com/registry/spec/auth/token/">Token authentication specification</a></li></ul></li><li><a onclick="navClicked(348)" data-target="#item348" data-toggle="collapse" data-parent="#stacked-menu" class="collapsed" aria-expanded="false">Registry storage drivers<span class="caret arrow"></span></a><ul class="nav collapse" id="#item348" aria-expanded="false"><li><a href="https://docs.docker.com/registry/storage-drivers/">Storage driver overview</a></li><li><a href="https://docs.docker.com/registry/storage-drivers/oss/">Aliyun OSS storage driver</a></li><li><a href="https://docs.docker.com/registry/storage-drivers/filesystem/">Filesystem storage driver</a></li><li><a href="https://docs.docker.com/registry/storage-drivers/gcs/">GCS storage driver</a></li><li><a href="https://docs.docker.com/registry/storage-drivers/inmemory/">In-memory storage driver</a></li><li><a href="https://docs.docker.com/registry/storage-drivers/azure/">Microsoft Azure storage driver</a></li><li><a href="https://docs.docker.com/registry/storage-drivers/s3/">S3 storage driver</a></li><li><a href="https://docs.docker.com/registry/storage-drivers/swift/">Swift storage driver</a></li></ul></li></ul></li><li><a href="https://docs.docker.com/glossary/">Glossary</a></li></ul>
                            </div>
                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul><li><a href="https://github.com/docker/cli/tree/master/docs/reference"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> Edit this page</a></li><li><a href="https://github.com/docker/docker.github.io/issues/new?body=File:%20[engine/reference/builder.md](https://docs.docker.com/engine/reference/builder/)" class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> Request docs changes</a></li>
                                        <li><div class="toggle-mode">
  <div class="icon">
      <i class="fa fa-sun-o" aria-hidden="true"></i>
  </div>
  <div class="toggle-switch">
      <label class="switch">
          <input type="checkbox" id="switch-style">
          <span class="slider round"></span>
      </label>
  </div>
  <div class="icon">
      <i class="fa fa-moon-o" aria-hidden="true"></i>
  </div>
</div>
</li>
                                    </ul>
                                </div><div id="side-toc-title">On this page:</div>
<ul id="my_toc" class="inline_toc">
  <li><a href="https://docs.docker.com/engine/reference/builder/#usage" class="nomunge">Usage</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#buildkit" class="nomunge">BuildKit</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#format" class="nomunge active">Format</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#parser-directives" class="nomunge">Parser directives</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#syntax" class="nomunge">syntax</a>
    <ul>
      <li><a href="https://docs.docker.com/engine/reference/builder/#official-releases" class="nomunge">Official releases</a></li>
    </ul>
  </li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#escape" class="nomunge">escape</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#environment-replacement" class="nomunge">Environment replacement</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#dockerignore-file" class="nomunge">.dockerignore file</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#from" class="nomunge">FROM</a>
    <ul>
      <li><a href="https://docs.docker.com/engine/reference/builder/#understand-how-arg-and-from-interact" class="nomunge">Understand how ARG and FROM interact</a></li>
    </ul>
  </li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#run" class="nomunge">RUN</a>
    <ul>
      <li><a href="https://docs.docker.com/engine/reference/builder/#known-issues-run" class="nomunge">Known issues (RUN)</a></li>
    </ul>
  </li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#cmd" class="nomunge">CMD</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#label" class="nomunge">LABEL</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#maintainer-deprecated" class="nomunge">MAINTAINER (deprecated)</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#expose" class="nomunge">EXPOSE</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#env" class="nomunge">ENV</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#add" class="nomunge">ADD</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#copy" class="nomunge">COPY</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#entrypoint" class="nomunge">ENTRYPOINT</a>
    <ul>
      <li><a href="https://docs.docker.com/engine/reference/builder/#exec-form-entrypoint-example" class="nomunge">Exec form ENTRYPOINT example</a></li>
      <li><a href="https://docs.docker.com/engine/reference/builder/#shell-form-entrypoint-example" class="nomunge">Shell form ENTRYPOINT example</a></li>
      <li><a href="https://docs.docker.com/engine/reference/builder/#understand-how-cmd-and-entrypoint-interact" class="nomunge">Understand how CMD and ENTRYPOINT interact</a></li>
    </ul>
  </li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#volume" class="nomunge">VOLUME</a>
    <ul>
      <li><a href="https://docs.docker.com/engine/reference/builder/#notes-about-specifying-volumes" class="nomunge">Notes about specifying volumes</a></li>
    </ul>
  </li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#user" class="nomunge">USER</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#workdir" class="nomunge">WORKDIR</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#arg" class="nomunge">ARG</a>
    <ul>
      <li><a href="https://docs.docker.com/engine/reference/builder/#default-values" class="nomunge">Default values</a></li>
      <li><a href="https://docs.docker.com/engine/reference/builder/#scope" class="nomunge">Scope</a></li>
      <li><a href="https://docs.docker.com/engine/reference/builder/#using-arg-variables" class="nomunge">Using ARG variables</a></li>
      <li><a href="https://docs.docker.com/engine/reference/builder/#predefined-args" class="nomunge">Predefined ARGs</a></li>
      <li><a href="https://docs.docker.com/engine/reference/builder/#automatic-platform-args-in-the-global-scope" class="nomunge">Automatic platform ARGs in the global scope</a></li>
      <li><a href="https://docs.docker.com/engine/reference/builder/#impact-on-build-caching" class="nomunge">Impact on build caching</a></li>
    </ul>
  </li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#onbuild" class="nomunge">ONBUILD</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#stopsignal" class="nomunge">STOPSIGNAL</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#healthcheck" class="nomunge">HEALTHCHECK</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#shell" class="nomunge">SHELL</a></li>
  <li><a href="https://docs.docker.com/engine/reference/builder/#dockerfile-examples" class="nomunge">Dockerfile examples</a></li>
</ul>

</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products" target="_blank" rel="noopener">Product offerings</a></b></li>
                        <li><a href="https://www.docker.com/products/personal" target="_blank" rel="noopener">Docker Personal</a></li>
                        <li><a href="https://www.docker.com/products/pro" target="_blank" rel="noopener">Docker Pro</a></li>
                        <li><a href="https://www.docker.com/products/team" target="_blank" rel="noopener">Docker Team</a></li>
                        <li><a href="https://www.docker.com/products/business" target="_blank" rel="noopener">Docker Business</a></li>
                        <li><a href="https://www.docker.com/products" target="_blank" rel="noopener">Compare Subscriptions</a></li>
                        <li><b><a href="https://www.docker.com/" target="_blank" rel="noopener">Features</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub" target="_blank" rel="noopener">Docker Hub</a></li>
                        <li><a href="https://www.docker.com/products/secure-software-supply-chain" target="_blank" rel="noopener">Secure Software Supply Chain</a></li>
                        <li><a href="https://www.docker.com/products/container-runtime" target="_blank" rel="noopener">Container Runtime</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools" target="_blank" rel="noopener">Developer Tools</a></li>
                        <li><a href="https://www.docker.com/partners" target="_blank" rel="noopener">Trusted Content</a></li>
                        <li><a href="https://www.docker.com/roadmap" target="_blank" rel="noopener">Docker Product Roadmap</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">Developers</a></b></li>
                        <li><a href="https://www.docker.com/use-cases" target="_blank" rel="noopener">Use Cases</a></li>
                        <li><a href="https://docs.docker.com/get-started/" target="_blank" rel="noopener">Get Started</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank" rel="noopener">Blog</a></li>
                        <li><a href="https://www.docker.com/docker-community" target="_blank" rel="noopener">Community</a></li>
                        <li><a href="https://www.docker.com/open-source" target="_blank" rel="noopener">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/get-involved/developer-preview" target="_blank" rel="noopener">Preview Program</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">Pricing</a></b></li>
                        <li><a href="https://www.docker.com/pricing/faq" target="_blank" rel="noopener">FAQ</a></li>
                        <li><a href="https://www.docker.com/partners/programs" target="_blank" rel="noopener">Docker Verified Publisher</a></li>
                        <li><a href="https://www.docker.com/partners" target="_blank" rel="noopener">Partners</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank" rel="noopener">About Us</a></b></li>
                        <li><a href="https://www.docker.com/what-container" target="_blank" rel="noopener">What is a Container?</a></li>
                        <li><a href="https://www.docker.com/why-docker" target="_blank" rel="noopener">Why Docker?</a></li>
                        <li><a href="https://www.docker.com/events" target="_blank" rel="noopener">Virtual Events</a></li>
                        <li><a href="https://www.docker.com/swag" target="_blank" rel="noopener">Swag Store
                        </a></li>
                        <li><a href="https://www.docker.com/company/newsroom" target="_blank" rel="noopener">Newsroom</a></li>
                        <li><a href="https://www.docker.com/careers" target="_blank" rel="noopener">Careers</a></li>
                        <li><a href="https://www.docker.com/company/contact" target="_blank" rel="noopener">Contact Us</a></li>
                        <li><a href="https://www.docker.com/customers" target="_blank" rel="noopener">Customers</a></li>
                        <li><a href="https://www.docker.com/newsletter-subscription" target="_blank" rel="noopener">Newsletter</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="https://www.docker.com/legal/docker-terms-service" target="_blank" rel="noopener">Terms of Service</a></li>
                        <li><a href="https://status.docker.com/" target="_blank" rel="noopener">Status</a></li>
                        <li><a href="https://www.docker.com/legal" target="_blank" rel="noopener">Legal</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright © 2013-2021 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="https://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="https://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <script>const pageURL = "/engine/reference/builder/";</script>
<script type="text/javascript" id="">(function(){function b(){!1===c&&(c=!0,Munchkin.init("790-SSB-375"))}var c=!1,a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="//munchkin.marketo.net/munchkin.js";a.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||b()};a.onload=b;document.getElementsByTagName("head")[0].appendChild(a)})();</script><script type="text/javascript" id="">var _analytics=_analytics||{};
(function(){function r(){var b=new Date,a=b.getTimezoneOffset(),c=b;b=new Date(c.getFullYear(),0,1);c=new Date(c.getFullYear(),6,1);b=Math.max(b.getTimezoneOffset(),c.getTimezoneOffset());return a<b}this.dataChannel=this.dataChannel||{};this.dataChannel.publishEvent=this.dataChannel.publishEvent||function(b,a){a=a||{};a.event=b;window.dataLayer&&dataLayer.push(a)};this.trackPageView=function(b,a){a=a||{};var c=google_tag_manager["GTM-WL2QLG5"].macro(4);c=this.getTimestamp(c);var d=google_tag_manager["GTM-WL2QLG5"].macro(5);d&&window.analytics&&
(b={hit_timestamp:c,title:a.title,path:b,url:window.location.href},Object.assign(b,this.contentGroups,this.pageDimensions,this.pageMetrics,a.dimensions,a.metrics),analytics.page(b))};this.trackEvent=function(b,a,c,d){d=d||{};var f=google_tag_manager["GTM-WL2QLG5"].macro(6);f=this.getTimestamp(f);var e=google_tag_manager["GTM-WL2QLG5"].macro(7);e&&window.analytics&&(b={hit_timestamp:f,category:b,label:c,value:"undefined"!=typeof d.value?Math.round(d.value):void 0,nonInteraction:d.nonInteraction},Object.assign(b,this.contentGroups,this.pageDimensions,
this.pageMetrics,d.dimensions,d.metrics),analytics.track(a,b))};this.contentGroups={};this.setContentGroup=function(b,a){"undefined"!=typeof b&&(this.contentGroups[b]=a)};this.contentGroups={};this.setContentGroup=function(b,a){"undefined"!=typeof b&&(isNaN(parseInt(b))?this.contentGroups[b]=a:this.contentGroups["content_group"+b]=a)};this.pageDimensions={};this.setDimension=function(b,a){"undefined"!=typeof b&&(this.pageDimensions[b]=a)};this.pageMetrics={};this.setMetric=function(b,a){"undefined"!=
typeof b&&(this.pageMetrics[b]=a)};this.getCookie=function(b){var a=document.cookie,c=a.indexOf(" "+b+"\x3d");-1==c&&(c=a.indexOf(b+"\x3d"),1<c&&(c=-1));-1==c?a=null:(c=a.indexOf("\x3d",c)+1,b=a.indexOf(";",c),-1==b&&(b=a.length),a=unescape(a.substring(c,b)));return a};this.setCookie=function(b,a,c){function d(h){23<h?(e.setDate(e.getDate()+1),e.setHours(h%23)):e.setHours(h)}function f(h){59<h?(d(e.getHours()+1),e.setMinutes(h%59)):e.setMinutes(h)}c=c||{};var e=new Date;if(c.minutes)f(e.getMinutes()+
c.minutes);else if(c.hours)d(e.getHours()+c.hours);else{var g=c.days||30;e.setDate(e.getDate()+g)}document.cookie=b+"\x3d"+a+";expires\x3d"+(c.sessionExpiry?"":e.toGMTString())+";path\x3d"+(c.path||"/")+";domain\x3d"+(c.domain||this.getTopLevelDomain())};this.deleteCookie=function(b,a){a=a||{};document.cookie=b+"\x3d;expires\x3dThu, 01-Jan-1970 00:00:01 GMT;path\x3d"+(a.path||"/")+";domain\x3d"+(a.domain||this.getTopLevelDomain())};this.getTopLevelDomain=function(){for(var b=document.domain.split(".").reverse(),
a="__test__",c=b[0],d=0;d<b.length;d++){document.cookie=a+"\x3d__test__;path\x3d/;domain\x3d"+c;if(null!=this.getCookie(a))return document.cookie=a+"\x3d;expires\x3dThu, 01-Jan-1970 00:00:01 GMT;path\x3d/;domain\x3d"+c,c;c=b[d+1]+"."+c}};this.getURLParameter=function(b,a){a=a||{};var c=a.url||location.search;b=decodeURI((RegExp("[?\x26]"+b+"\x3d([^\x26#]*)","i").exec(c)||[,""])[1]);return!b&&a.defaultValue?a.defaultValue:b};this.ready=function(b){/in/.test(document.readyState)?setTimeout("_analytics.ready("+
b+")",9):b()};this.jQueryReady=function(b){window.jQuery?b():setTimeout("_analytics.jQueryReady("+b+")",9)};this.appendScript=function(b,a){a=a||{};var c=document.createElement("script");c.type="text/javascript";c.async="true";c.src=b;if(a.callback){var d=!1;c.onload=c.onreadystatechange=function(){d||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(d=!0,a.callback(),c.onload=c.onreadystatechange=null)}}a.scope?a.scope.appendChild(c):document.getElementsByTagName("head")[0].appendChild(c)};
this.getTimestamp=function(b){function a(d){return("0"+d).slice(-2)}b=isNaN(b)?-8:parseInt(b);b=r()?b+1:b;var c=new Date;c=c.getTime()+6E4*c.getTimezoneOffset();b=new Date(c+36E5*b);return b.getFullYear()+"/"+a(b.getMonth()+1)+"/"+a(b.getDate())+" "+a(b.getHours())+":"+a(b.getMinutes())+":"+a(b.getSeconds())+"."+("00"+b.getMilliseconds()).slice(-3)};this.onEvent=function(b,a,c){function d(g,h,m){var k=g.target||g.srcElement;if(m||"function"!=typeof h)if(h||"function"!=typeof m){var n=[];if("string"==
typeof h)for(var q=h.split(","),l=0;l<q.length;l++)n.push(function(p){return p&&p.matches&&p.matches(q[l].trim())});else n.push(h);do for(l=0;l<n.length;l++)if(h=n[l],h(k)){m.call(k,g);return}while(k=k&&k.parentNode)}else m.call(k,g);else h.call(k,g)}var f=document,e=function(g){d(g,a,c)};f.addEventListener?f.addEventListener(b,e,!0):f.attachEvent&&f.attachEvent("on"+b,e);return e};Date.now||(Date.now=function(){return(new Date).getTime()});String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
"")});Array.prototype.filter||(Array.prototype.filter=function(b,a){if("Function"!==typeof b&&"function"!==typeof b||!this)throw new TypeError;var c=this.length>>>0,d=Array(c),f=this,e=0,g=-1;if(void 0===a)for(;++g!==c;)if(g in this)if(b(f[g],g,f))d[e++]=f[g];else for(;++g!==c;)g in this&&b.call(a,f[g],g,f)&&(d[e++]=f[g]);d.length=e;return d});Array.prototype.indexOf||(Array.prototype.indexOf=function(b,a){if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),d=c.length>>>
0;if(0===d)return-1;a=+a||0;Infinity===Math.abs(a)&&(a=0);if(a>=d)return-1;for(a=Math.max(0<=a?a:d-Math.abs(a),0);a<d;){if(a in c&&c[a]===b)return a;a++}return-1});Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(b,a){if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),d=c.length>>>0;if(0===d)return!1;a|=0;for(a=Math.max(0<=a?a:d-Math.abs(a),0);a<d;){var f=c[a];var e=b;if(f=f===e||"number"===typeof f&&"number"===typeof e&&
isNaN(f)&&isNaN(e))return!0;a++}return!1}});String.prototype.includes||(String.prototype.includes=function(b,a){"number"!==typeof a&&(a=0);return a+b.length>this.length?!1:-1!==this.indexOf(b,a)});Element.prototype.matches=Element.prototype.matches||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector;!Element.prototype.matches&&document.querySelectorAll&&(Element.prototype.matches=function(b){var a=
this;b=(a.document||a.ownerDocument).querySelectorAll(b);for(var c=b.length;0<=--c&&b.item(c)!==a;);return-1<c});"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(b,a){if(null==b)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(b),d=1;d<arguments.length;d++){var f=arguments[d];if(null!=f)for(var e in f)Object.prototype.hasOwnProperty.call(f,e)&&(c[e]=f[e])}return c},writable:!0,configurable:!0})}).apply(_analytics);</script><script type="text/javascript" id="">var _analytics=_analytics||{};
(function(){var e="Ecommerce";this.trackPurchase=function(a,d){d=d||{};var b=google_tag_manager["GTM-WL2QLG5"].macro(8);if(b&&window.analytics){b=d;var c=google_tag_manager["GTM-WL2QLG5"].macro(9);c=_analytics.getTimestamp(c);c={hit_timestamp:c,category:b.eventCategory||_analytics.getPageTemplate&&_analytics.getPageTemplate()||e,label:b.eventLabel};Object.assign(c,_analytics.contentGroups,_analytics.pageDimensions,_analytics.pageMetrics,b.dimensions,b.metrics);b=c;Object.assign(b,{nonInteraction:/false/i.test(d.nonInteraction)?!1:!0,id:a.id,
affiliation:a.affiliation,revenue:a.revenue,tax:a.tax,shipping:a.shipping,coupon:a.coupon,products:a.products instanceof Array?a.products:[a.products]});analytics.track("Order Completed",b)}}}).apply(_analytics);</script><script type="text/javascript" id="">var _analytics=_analytics||{};
(function(){function b(a){return/mktoForm/.test(a.id)?_analytics.getMarketoFormName():location.href.includes("https://trial.docker.com/")?"Docker Enterprise Hosted Trial":"Form: "+f(a,google_tag_manager["GTM-WL2QLG5"].macro(10))}function f(a,c){for(var e=[],d=0;d<c.length;d++){var b=a.getAttribute(c[d]);b&&e.push(c[d]+"\x3d"+b)}return 0==e.length?"(No Identifying Attributes)":e.join(", ")}var g="Global Forms";this.trackFormSubmission=function(a){a&&(a=b(a),-1==a.indexOf("action\x3dhttps://www.facebook.com/tr/")&&"Form: (No Identifying Attributes)"!=
a&&(-1!=a.indexOf("Form: id\x3dsearch-form, action\x3d/search/node")&&(a="Form: id\x3dsearch-form, action\x3d/search/node"),this.trackEvent(_analytics.getPageTemplate&&_analytics.getPageTemplate()||g,"Form - submission",a)))};this.trackFormFieldInteraction=function(a){if(a){var c=a.form?b(a.form):"Form: (No Associated Form)";a="Field: "+f(a,google_tag_manager["GTM-WL2QLG5"].macro(11));this.trackEvent(_analytics.getPageTemplate&&_analytics.getPageTemplate()||g,"Form Field - interaction",c+" | "+a)}};this.tagFormFields=
function(){_analytics.onEvent("blur","input[type\x3ddate]",function(){_analytics.trackFormFieldInteraction(this)});_analytics.onEvent("click","input[type\x3dradio], input[type\x3dcheckbox], input[type\x3dbutton]",function(){_analytics.trackFormFieldInteraction(this)});_analytics.onEvent("change","select, textarea, input[type\x3dtext], input[type\x3demail]",function(){_analytics.trackFormFieldInteraction(this)})}}).apply(_analytics);</script><script type="text/javascript" id="">var _analytics=_analytics||{};
(function(){function f(){return _analytics.getPageTemplate&&_analytics.getPageTemplate()||k}var k="Global Links";this.trackLinkClick=function(c){if(c){var d=c.href,g=c.id;if(d&&!d.match(/^javascript:/i))if(d.match(/^mailto:/i))this.trackEvent(f(),"Email - click",d.replace(/^mailto:/i,""),{dimensions:{link_destination_url:d.replace(/^mailto:/i,""),link_id:g}});else if(d.match(/^tel:/i))this.trackEvent(f(),"Phone Number - click",d.replace(/^tel:|\D/ig,""),{dimensions:{link_destination_url:d.replace(/^tel:|\D/ig,""),
link_id:g}});else if(d.match(/^https?:/i)){var a=c;var b="exe zip wav mp3 mov mpg avi wmv pdf doc docx xls xlsx ppt pptx dmg".split(" ");b=new RegExp(".*\\.("+b.join("|")+")(\\?.*|#.*)?$","i");b.test(a.href)?(b=a.href.match(b)[1].toUpperCase(),_analytics.trackEvent(f(),"Download "+b+" - click",a.href,{dimensions:{link_destination_url:a.href,link_id:a.id}}),a=!0):a=!1;if(!a){a:{a=c;b=google_tag_manager["GTM-WL2QLG5"].macro(12);for(var e=0;e<b.length;e++){var l=b[e][0],m=b[e][1],h=b[e][2];if(h&&h.test(a.href)){_analytics.trackEvent(f(),
m,l+" | "+a.href,{dimensions:{link_destination_url:a.href,link_id:a.id}});a=!0;break a}}a=!1}if(!a){if(c.hostname){c=c.hostname;a=-1!=c.indexOf(_analytics.getTopLevelDomain());if(!a)for(b=google_tag_manager["GTM-WL2QLG5"].macro(13)||[],e=0;e<b.length;e++)if(-1!=c.indexOf(b[e].toLowerCase())){a=!0;break}c=a}else c=!0;c?g&&this.trackEvent(f(),"Internal Link - click",d,{dimensions:{link_destination_url:d,link_id:g}}):this.trackEvent(f(),"Outbound Link - click",d,{dimensions:{link_destination_url:d,link_id:g}})}}}}}}).apply(_analytics);</script><script type="text/javascript" id="">var _analytics=_analytics||{};
(function(){this.getClientId=function(){if(window.ga&&ga.getAll){var a=ga.getAll();if(0<a.length)return a[0].get("clientId")}if(a=_analytics.getCookie("_ga"))if(a=a.split("."),3<a.length)return a[2]+"."+a[3]};this.getMouseflowSessionId=function(){var a;window.mouseflow&&mouseflow.getSessionId&&(a=mouseflow.getSessionId());return a};this.getMarketoFormName=function(){var a={"www.docker.com/blog":"Newsletter Subscription"};try{for(var b in a)if(a.hasOwnProperty(b)&&location.href.toLowerCase().includes(b))return a[b];var d=
document.querySelector("title"),c=(d.textContent||d.innerText).replace(/\| Docker$/,"").trim();"Contact Us - Address \x26 Phone Number"==c?c="Contact Us":/\/resources\//i.test(location.pathname)&&(c="Resource - "+c);return c}catch(e){}};this.getOptimizelyExperimentData=function(){try{if(window.optimizely&&optimizely.get&&optimizely.get("data")){for(var a=[],b=0;b<optimizely.get("state").getActiveExperimentIds().length;b++){var d=optimizely.get("state").getActiveExperimentIds()[b];if(optimizely.get("data").experiments[d]){var c=
optimizely.get("state").getVariationMap()[d].id;a.push(d+":"+c)}}if(a.length)return a.join(" | ")}}catch(e){}}}).apply(_analytics);</script><script type="text/javascript" id="">(function(){if(google_tag_manager["GTM-WL2QLG5"].macro(14)){!function(){var a=window.analytics=window.analytics||[];if(!a.initialize)if(a.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{a.invoked=!0;a.methods="trackSubmit trackClick trackLink trackForm pageview identify reset group track ready alias debug page once off on".split(" ");a.factory=function(b){return function(){var d=Array.prototype.slice.call(arguments);d.unshift(b);a.push(d);return a}};for(var b=0;b<a.methods.length;b++){var c=
a.methods[b];a[c]=a.factory(c)}a.load=function(b,d){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src="https://cdn.segment.com/analytics.js/v1/"+b+"/analytics.min.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(e,c);a._loadOptions=d};a.SNIPPET_VERSION="4.1.0";a.load(google_tag_manager["GTM-WL2QLG5"].macro(15))}}();analytics.ready(function(){window.ga&&(ga("require","linker"),ga("linker:autoLink",google_tag_manager["GTM-WL2QLG5"].macro(16)))});var f=0,g=300,h=setInterval(function(){if(window.ga&&
ga.hasOwnProperty("loaded")&&!0===ga.loaded||++f>=g)clearInterval(h),_analytics.dataChannel.publishEvent("Track Page View")},9)}})();</script><script type="text/javascript" id="">var DATALAYER_OBJECT_NAME="dataLayer",referrerOverride=function(a){var c=window[DATALAYER_OBJECT_NAME]||[];c.push({event:"optimizely-referrer-override","optimizely-referrer":a})},sendCampaignData=function(a,c){if(a=optimizely.get("data")&&optimizely.get("data").campaigns[a]&&optimizely.get("data").campaigns[a].integrationSettings&&optimizely.get("data").campaigns[a].integrationSettings.google_universal_analytics&&optimizely.get("data").campaigns[a].integrationSettings.google_universal_analytics.universal_analytics_slot){var e=
window[DATALAYER_OBJECT_NAME]||[];e.push({event:"campaign-decided","optimizely-dimension-value":c,"optimizely-dimension-number":a})}},initNewOptimizelyIntegration=function(a,c){var e=!1,g=function(b){var d=window.optimizely.get&&window.optimizely.get("state"),f=d.getRedirectInfo()&&d.getRedirectInfo().referrer;!e&&f&&(a(f),e=!0);d=d.getDecisionString({campaignId:b});c(b,d)},h=function(){window.optimizely=window.optimizely||[];window.optimizely.push({type:"addListener",filter:{type:"lifecycle",name:"campaignDecided"},
handler:function(b){b=b.data.campaign.id;g(b)}})},k=function(){var b=window.optimizely&&window.optimizely.get&&window.optimizely.get("state");if(b){b=b.getCampaignStates({isActive:!0});for(var d in b)g(d)}};k();h()},initOptimizelyIntegration=function(a,c){initNewOptimizelyIntegration(a,c)};initOptimizelyIntegration(referrerOverride,sendCampaignData);</script><script type="text/javascript" id="" src="./Dockerfile reference _ Docker Documentation_files/19408130739.js"></script><script type="text/javascript" id="">var docker_global_alert_id="cve-2021-44228-01",docker_global_alert_text='Get the latest on Apache Log4j 2 CVE-2021-44228 vulnerability from \x3ca id\x3d"dkr_log4j_global_banner" href\x3d"https://www.docker.com/blog/apache-log4j-2-cve-2021-44228/"\x3eDocker\x3c/a\x3e';
function gtm_handleCanvas(a){a.style.cssText="text-align:center;display:block;width:100%;min-height:38px;padding:10px 40px;background:#002c66;text-align:center;color:white;font-size:13px;font-weight:600;";a.innerHTML=window.docker_global_alert_text;var b=document.createElement("div");b.setAttribute("id","docker-global-alert-dismiss");b.style.cssText="cursor:pointer;position:absolute;top:6px;right:14px;font-size:16px;";b.textContent="\u2715";b.addEventListener("click",function(e){a.style.cssText="display:none;";
e="docker-global-alert-id\x3d"+escape(window.docker_global_alert_id)+";";var d=14,c=new Date;c.setTime(c.getTime()+864E5*d);d="expires\x3d"+c.toUTCString()+";";c="path\x3d/;domain\x3ddocker.com";document.cookie=e+d+c});a.appendChild(b)}
function gtm_prependAnnouncementBar(){var a=document.createElement("div");a.setAttribute("id","announcement-bar");a.style.cssText="display:block;width:100%;min-height:38px;padding:10px 40px;background:#002c66;text-align:center;color:white;font-size:13px;font-weight:600;";document.body.insertBefore(a,document.body.firstChild);return a}
function gtm_getAnnouncementSelector(){var a=window.location.hostname,b="#announcement-bar";switch(!0){case /hub/.test(a):(a=document.querySelector('[data-testid\x3d"topBannerText"]'))&&a.textContent.includes("DockerCon")&&(a.parentElement.style.display="none");break;case /docs/.test(a):(a=document.getElementById("announcement-bar"))||gtm_prependAnnouncementBar()}return b}var match=document.cookie.match(RegExp("(^| )docker-global-alert-id\x3d([^;]+)"));
if(match&&0==match[2].localeCompare(window.docker_global_alert_id)||"disabled"==docker_global_alert_id){var selector=gtm_getAnnouncementSelector(),canvas=document.querySelector(selector);canvas&&(canvas.style.cssText="display:none;")}else{var observer=new MutationObserver(function(a,b){a=gtm_getAnnouncementSelector();if(a=document.querySelector(a))gtm_handleCanvas(a),b.disconnect()});observer.observe(document,{childList:!0,subtree:!0})};</script><iframe src="./Dockerfile reference _ Docker Documentation_files/a14166430330.html" hidden="" tabindex="-1" title="Optimizely Internal Frame" height="0" width="0" style="display: none;"></iframe><script>
    let PDRTJS_settings_8453675 = {
        "id": "8453675",
        "unique_id": "engine/reference/builder.md",
        "title": "Dockerfile reference",
        "font_family": "Open Sans, sans serif",
        "font_color": "b9c2cc",
        "font_align": "center",
        "permalink": "https://github.com/docker/docker.github.io/blob/master/engine/reference/builder.md"
    };
    (function (d, c, j) {
        if (!document.getElementById(j)) {
            let pd=d.createElement(c),s;pd.id=j;pd.src='https://polldaddy.com/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd, s);
        }
    }(document, 'script', 'pd-rating-js'));
</script>

<script type="text/javascript" id="">(function(){_analytics.setDimension("page_url",window.location.href);_analytics.setDimension("page_referrer",document.referrer);_analytics.setDimension("browser_user_agent",navigator.userAgent);_analytics.setDimension("client_id",_analytics.getClientId());_analytics.setDimension("user_id",google_tag_manager["GTM-WL2QLG5"].macro(19));_analytics.setDimension("mouseflow_session_id",_analytics.getMouseflowSessionId());/^hub(-stage)?\.docker\.com$/.test(location.hostname)||_analytics.trackPageView(void 0,{dimensions:{optimizely_experiment_data:_analytics.getOptimizelyExperimentData()}})})();
_analytics.dataChannel.publishEvent("Track Events");</script><script type="text/javascript" id="">/yes|true|on/i.test(String(google_tag_manager["GTM-WL2QLG5"].macro(21)))&&_analytics.tagFormFields();window.MktoForms2&&MktoForms2.whenReady&&MktoForms2.whenReady(function(a){a.onSuccess(function(a,b){window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:"mkto.form.success"});_analytics.trackEvent("Global Forms","Form - submission",_analytics.getMarketoFormName())})});</script></body></html>